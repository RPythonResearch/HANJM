<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.553">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="JM HAN">
    <meta name="author" content="Ui Sep Shin">
    <meta name="keywords" content="colorectal cancer, liver metastases, preoperative chemotherapy, survival">

    <title>Role of Targeted Therapy after Surgical Resection of Colorectal Liver Metastases</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  
      <meta name="citation_title" content="Role of Targeted Therapy after Surgical Resection of Colorectal Liver Metastases">
<meta name="citation_keywords" content="colorectal cancer,liver metastases,preoperative chemotherapy,survival">
<meta name="citation_author" content="JM HAN">
<meta name="citation_author" content="Ui Sep Shin">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Colorectal metastasis (liver and lung);,citation_abstract=Distant metastases are the major cause of death for colorectal carcinoma patients. Depending on the primary tumor’s stage, liver metastases occur in 20;,citation_author=C. Penna;,citation_author=B. Nordlinger;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_issue=5;,citation_doi=10.1016/s0039-6109(02)00051-8;,citation_issn=0039-6109 (Print)
0039-6109;,citation_volume=82;,citation_journal_title=Surg Clin North Am;">
<meta name="citation_reference" content="citation_title=Systemic chemotherapy with or without cetuximab in patients with resectable colorectal liver metastasis: The new EPOC randomised controlled trial;,citation_abstract=BACKGROUND: Surgery for colorectal liver metastases results in an overall survival of about 40;,citation_author=J. Primrose;,citation_author=S. Falk;,citation_author=M. Finch-Jones;,citation_author=J. Valle;,citation_author=D. O’Reilly;,citation_author=A. Siriwardena;,citation_author=J. Hornbuckle;,citation_author=M. Peterson;,citation_author=M. Rees;,citation_author=T. Iveson;,citation_author=T. Hickish;,citation_author=R. Butler;,citation_author=L. Stanton;,citation_author=E. Dixon;,citation_author=L. Little;,citation_author=M. Bowers;,citation_author=S. Pugh;,citation_author=O. J. Garden;,citation_author=D. Cunningham;,citation_author=T. Maughan;,citation_author=J. Bridgewater;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_issue=6;,citation_doi=10.1016/s1470-2045(14)70105-6;,citation_issn=1470-2045;,citation_volume=15;,citation_journal_title=Lancet Oncol;">
<meta name="citation_reference" content="citation_title=Colorectal metastasis (liver and lung) - PubMed;,citation_fulltext_html_url=https://pubmed.ncbi.nlm.nih.gov/12507210/;">
<meta name="citation_reference" content="citation_title=Colorectal metastasis (liver and lung) - PubMed;,citation_fulltext_html_url=https://pubmed.ncbi.nlm.nih.gov/12507210/;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./index.qmd" class="btn btn-primary quarto-download-embed" download="index.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Role of Targeted Therapy after Surgical Resection of Colorectal Liver Metastases</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">JM HAN </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        KIRAMS
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Ui Sep Shin <a href="mailto:uisupshin@kirams.re.kr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-1714-7469" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        KIRAMS
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>


    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>colorectal cancer, liver metastases, preoperative chemotherapy, survival</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">2</span> Methods</a>
  <ul class="collapse">
  <li><a href="#patients" id="toc-patients" class="nav-link" data-scroll-target="#patients"><span class="header-section-number">2.1</span> Patients</a></li>
  <li><a href="#statistical-analyses" id="toc-statistical-analyses" class="nav-link" data-scroll-target="#statistical-analyses"><span class="header-section-number">2.2</span> Statistical analyses</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4</span> Conclusion</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">5</span> Discussion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>source_directory<span class="ot">&lt;-</span><span class="st">"source"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>source_filename<span class="ot">&lt;-</span><span class="st">"my_functions.R"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>source_path <span class="ot">&lt;&lt;-</span> <span class="fu">file.path</span>(project_path, source_directory)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>source_path_filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(source_path, source_filename)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(source_path_filename)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>source_filename<span class="ot">&lt;-</span><span class="st">"mycphwt.R"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>source_path_filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(source_path, source_filename)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(source_path_filename)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(source_directory, source_filename, project_path, source_path, source_path_filename)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>raw_data_directory<span class="ot">&lt;-</span><span class="st">"raw_data"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>raw_data_filename<span class="ot">&lt;-</span><span class="st">"deidentified_han20230213.xlsx"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>raw_data_path <span class="ot">&lt;&lt;-</span> <span class="fu">file.path</span>(project_path, raw_data_directory)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>raw_data_path_filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(raw_data_path, raw_data_filename)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(raw_data_path_filename)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(raw_data_directory, raw_data_filename, project_path, raw_data_path, raw_data_path_filename)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 교육적 목적으로 원본 데이터를 inital_raw_data에 복사해 두고 필요시 비교합니다.</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>initial_raw_data<span class="ot">&lt;-</span>raw_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw_data의 컬럼중에서 결측치가 cut-off 값 (아래에서는 5%) 이상이면 컬럼 삭제</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 어떤 컬럼이 삭제되는지 NA수와 함께 출력함.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 실행을 원치 않으면 옵션 eval: false로 변경하면 됨</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>cleaned_data<span class="ot">&lt;-</span><span class="fu">my_eliminate_NA_columns</span>(raw_data, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns with NAs above the threshold:
과거.암병력: 142 NAs
Comobidity..MI.CHF.PVD.CVA.dementia.COPD.CD.PU.LD.DM.hemipl.CKD..: 78 NAs
COMMENT: 150 NAs</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">my_eliminate_NA_rows</span>(cleaned_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>typecasted_data <span class="ot">&lt;-</span> cleaned_data</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>typecasted_data<span class="sc">$</span>SEX <span class="ot">&lt;-</span> <span class="fu">factor</span>(typecasted_data<span class="sc">$</span>SEX, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>typecasted_data<span class="sc">$</span>ASA <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(typecasted_data<span class="sc">$</span>ASA)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>typecasted_data<span class="sc">$</span>ECOG <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(typecasted_data<span class="sc">$</span>ECOG)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>typecasted_data<span class="ot">&lt;-</span><span class="fu">my_typecasting</span>(typecasted_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(dplyr))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my_plot_columns</span>(typecasted_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(dplyr))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>raw_data<span class="ot">&lt;-</span>cleaned_data</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> raw_data <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(MRN, PreHR_chemo,  PreHR_TA, Adjuvant_Doublet, Adju_TA, Any_TA, AGE, SEX, ASA, CCI, SIDENESS, pT4, pT, pN, tN, L, N, V, Diff, Synch_M1, M1_12m, BILOBE, NUM_HM, MULTI4, HM_SIZE, SIZE4, preHR_CEA, Post_HR_target_all, FU_DFS, DEATH, FU_OS, RECUR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(raw_data, Adjuvant_Doublet<span class="sc">==</span><span class="st">"1"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>HAN<span class="ot">&lt;-</span>selected_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maxstat)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># maxstat.test를 위한 time object 생성</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>TS_DFS<span class="ot">=</span><span class="fu">Surv</span>(HAN<span class="sc">$</span>FU_DFS, HAN<span class="sc">$</span>RECUR<span class="sc">==</span><span class="st">"1"</span>) <span class="co">#time object</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 변수파생</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>LNR<span class="ot">&lt;-</span>HAN<span class="sc">$</span>pN<span class="sc">/</span>HAN<span class="sc">$</span>tN</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal cut-off를 찾기 위한 maxstat.test</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> preHR_CEA, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Maximally selected LogRank statistics using condMC

data:  TS_DFS by preHR_CEA
M = 2.6206, p-value = 0.0951
sample estimates:
estimated cutpoint 
             73.97 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> CCI, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Maximally selected LogRank statistics using condMC

data:  TS_DFS by CCI
M = 0.92138, p-value = 0.6967
sample estimates:
estimated cutpoint 
                 7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> ASA, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Maximally selected LogRank statistics using condMC

data:  TS_DFS by ASA
M = 0.25305, p-value = 0.7748
sample estimates:
estimated cutpoint 
                 2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> NUM_HM, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Maximally selected LogRank statistics using condMC

data:  TS_DFS by NUM_HM
M = 2.9713, p-value = 0.006006
sample estimates:
estimated cutpoint 
                 4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> HM_SIZE, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Maximally selected LogRank statistics using condMC

data:  TS_DFS by HM_SIZE
M = 1.2944, p-value = 0.7808
sample estimates:
estimated cutpoint 
                 4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> LNR, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Maximally selected LogRank statistics using condMC

data:  TS_DFS by LNR
M = 1.3978, p-value = 0.6456
sample estimates:
estimated cutpoint 
         0.1818182 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maxstat. optimal cut-off에 따른 이분화</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>CEA73<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>preHR_CEA<span class="sc">&gt;</span><span class="dv">73</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>CCI7<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>CCI<span class="sc">&gt;</span><span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>CCI7<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>CCI<span class="sc">&gt;</span><span class="dv">7</span>,<span class="st">"CCI&gt;7"</span>,<span class="st">"CCI&lt;7"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>ASA3<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>ASA<span class="sc">&gt;</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 저자의 직관에 의한 이분화</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>AGE60<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>AGE<span class="sc">&gt;</span><span class="dv">60</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># categorical 변수의 숫자화 ?</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>PD<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>Diff<span class="sc">==</span><span class="st">"PD"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Pni1<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>N<span class="sc">==</span><span class="st">"Y"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Vi1<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>V<span class="sc">==</span><span class="st">"Y"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Lvi1<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>L<span class="sc">==</span><span class="st">"Y"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Male<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>SEX<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>RTCOL<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>SIDENESS<span class="sc">==</span><span class="st">"Rt"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인화</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Adju_target<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>Post_HR_target_all<span class="sc">==</span><span class="st">"None"</span>,<span class="dv">0</span>,<span class="fu">ifelse</span>(HAN<span class="sc">$</span>Post_HR_target_all<span class="sc">==</span><span class="st">"Avastin"</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Adju_target <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN<span class="sc">$</span>Adju_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moonBook)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">mytable</span>(Adju_TA<span class="sc">~</span>AGE<span class="sc">+</span>Male<span class="sc">+</span>Synch_M1<span class="sc">+</span>M1_12m<span class="sc">+</span>ASA3<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>preHR_CEA<span class="sc">+</span>CEA73<span class="sc">+</span>PreHR_chemo<span class="sc">+</span>PreHR_TA<span class="sc">+</span>Post_HR_target_all,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">show.total=</span><span class="cn">TRUE</span>, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">data=</span>HAN, <span class="at">method =</span> <span class="dv">3</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                    Descriptive Statistics by 'Adju_TA'                    
———————————————————————————————————————————————————————————————————————————— 
                           0                1              Total         p  
                         (N=77)           (N=61)          (N=138)     
———————————————————————————————————————————————————————————————————————————— 
 AGE                  59.0 ± 10.5      59.1 ±  9.0      59.1 ±  9.8    0.974
 Male                                                                  0.888
   - 0                 22 (28.6%)       19 (31.1%)       41 (29.7%)         
   - 1                 55 (71.4%)       42 (68.9%)       97 (70.3%)         
 Synch_M1                                                              0.121
   - M0                12 (15.6%)       17 (27.9%)       29 (21.0%)         
   - M1                65 (84.4%)       44 (72.1%)      109 (79.0%)         
 M1_12m                                                                0.025
   - M0                7 ( 9.1%)        15 (24.6%)       22 (15.9%)         
   - M1                70 (90.9%)       46 (75.4%)      116 (84.1%)         
 ASA3                                                                  0.382
   - 0                 60 (77.9%)       52 (85.2%)      112 (81.2%)         
   - 1                 17 (22.1%)       9 (14.8%)        26 (18.8%)         
 CCI7                                                                  1.000
   - CCI&lt;7             37 (48.1%)       29 (47.5%)       66 (47.8%)         
   - CCI&gt;7             40 (51.9%)       32 (52.5%)       72 (52.2%)         
 RTCOL                                                                 0.961
   - 0                 63 (81.8%)       51 (83.6%)      114 (82.6%)         
   - 1                 14 (18.2%)       10 (16.4%)       24 (17.4%)         
 LNR                 0.1 [ 0.0; 0.2]  0.1 [ 0.0; 0.3]  0.1 [ 0.0; 0.3] 0.476
 pT4                                                                   0.211
   - 0                 64 (83.1%)       56 (91.8%)      120 (87.0%)         
   - 1                 13 (16.9%)       5 ( 8.2%)        18 (13.0%)         
 Pni1                                                                  0.599
   - 0                 46 (59.7%)       40 (65.6%)       86 (62.3%)         
   - 1                 31 (40.3%)       21 (34.4%)       52 (37.7%)         
 Lvi1                                                                  0.032
   - 0                 42 (54.5%)       45 (73.8%)       87 (63.0%)         
   - 1                 35 (45.5%)       16 (26.2%)       51 (37.0%)         
 Vi1                                                                   0.619
   - 0                 54 (70.1%)       46 (75.4%)      100 (72.5%)         
   - 1                 23 (29.9%)       15 (24.6%)       38 (27.5%)         
 PD                                                                    1.000
   - 0                 74 (96.1%)       58 (95.1%)      132 (95.7%)         
   - 1                 3 ( 3.9%)        3 ( 4.9%)        6 ( 4.3%)          
 BILOBE                                                                0.468
   - 0                 46 (59.7%)       41 (67.2%)       87 (63.0%)         
   - 1                 31 (40.3%)       20 (32.8%)       51 (37.0%)         
 MULTI4                                                                0.183
   - 0                 65 (84.4%)       45 (73.8%)      110 (79.7%)         
   - 1                 12 (15.6%)       16 (26.2%)       28 (20.3%)         
 SIZE4                                                                 0.392
   - 0                 66 (85.7%)       48 (78.7%)      114 (82.6%)         
   - 1                 11 (14.3%)       13 (21.3%)       24 (17.4%)         
 preHR_CEA           9.2 [ 3.2;25.1]  7.3 [ 4.8;44.4]  8.3 [ 3.7;28.0] 0.394
 CEA73                                                                 0.445
   - 0                 70 (90.9%)       52 (85.2%)      122 (88.4%)         
   - 1                 7 ( 9.1%)        9 (14.8%)        16 (11.6%)         
 PreHR_chemo                                                           0.028
   - 0                 61 (79.2%)       37 (60.7%)       98 (71.0%)         
   - 1                 16 (20.8%)       24 (39.3%)       40 (29.0%)         
 PreHR_TA                                                              0.000
   - 0                 75 (97.4%)       40 (65.6%)      115 (83.3%)         
   - 1                 2 ( 2.6%)        21 (34.4%)       23 (16.7%)         
 Post_HR_target_all                                                    0.000
   - Avastin            0 ( 0.0%)       42 (68.9%)       42 (30.4%)         
   - Erbitux            0 ( 0.0%)       19 (31.1%)       19 (13.8%)         
   - None             77 (100.0%)        0 ( 0.0%)       77 (55.8%)         
———————————————————————————————————————————————————————————————————————————— </code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>out_u<span class="ot">=</span><span class="fu">mycph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Any_TA<span class="sc">+</span>Adju_target<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_chemo<span class="sc">+</span>PreHR_TA, <span class="at">data=</span>HAN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 mycph : perform coxph of individual expecting variables

 Call: TS_DFS ~ Adju_TA + Any_TA + Adju_target + SEX + AGE60 + CCI7 +     RTCOL + LNR + pT4 + Pni1 + Lvi1 + Vi1 + PD + BILOBE + MULTI4 +     SIZE4 + CEA73 + M1_12m + PreHR_chemo + PreHR_TA, data= HAN </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>out_u</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               HR  lcl  ucl     p
Adju_TA      1.48 0.96 2.28 0.074
Any_TA       1.48 0.96 2.27 0.075
Adju_target1 1.36 0.84 2.18 0.208
Adju_target2 1.89 1.00 3.56 0.049
SEX          0.89 0.57 1.40 0.620
AGE60        0.92 0.60 1.41 0.704
CCI7CCI&gt;7    0.82 0.53 1.25 0.352
RTCOL        1.08 0.63 1.87 0.773
LNR          1.62 0.56 4.67 0.375
pT4          1.19 0.63 2.25 0.582
Pni1         1.23 0.80 1.89 0.347
Lvi1         1.07 0.69 1.64 0.774
Vi1          1.72 1.09 2.70 0.019
PD           0.79 0.25 2.50 0.688
BILOBE       1.57 1.02 2.43 0.040
MULTI4       2.18 1.32 3.59 0.002
SIZE4        1.30 0.76 2.21 0.333
CEA73        2.00 1.13 3.56 0.018
M1_12mM1     1.43 0.76 2.69 0.270
PreHR_chemo  1.44 0.91 2.27 0.123
PreHR_TA     1.87 1.10 3.21 0.022</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>out_m<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Any_TA<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73, <span class="at">data=</span>HAN)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extractHR(out_m)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>DFS_step<span class="ot">&lt;-</span><span class="fu">step</span>(out_m, <span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=738.38
TS_DFS ~ Any_TA + SEX + AGE60 + Vi1 + BILOBE + MULTI4 + CEA73

         Df    AIC
- SEX     1 736.38
- AGE60   1 736.56
- BILOBE  1 737.50
- MULTI4  1 737.78
- CEA73   1 738.19
&lt;none&gt;      738.38
- Any_TA  1 740.23
- Vi1     1 740.69

Step:  AIC=736.38
TS_DFS ~ Any_TA + AGE60 + Vi1 + BILOBE + MULTI4 + CEA73

         Df    AIC
- AGE60   1 734.56
- BILOBE  1 735.50
- MULTI4  1 735.78
- CEA73   1 736.26
&lt;none&gt;      736.38
- Any_TA  1 738.23
- Vi1     1 738.71

Step:  AIC=734.56
TS_DFS ~ Any_TA + Vi1 + BILOBE + MULTI4 + CEA73

         Df    AIC
- BILOBE  1 733.59
- MULTI4  1 734.16
&lt;none&gt;      734.56
- CEA73   1 734.57
- Any_TA  1 736.25
- Vi1     1 736.78

Step:  AIC=733.59
TS_DFS ~ Any_TA + Vi1 + MULTI4 + CEA73

         Df    AIC
&lt;none&gt;      733.59
- CEA73   1 733.77
- Any_TA  1 734.45
- Vi1     1 735.68
- MULTI4  1 737.41</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Cox_step_dfs<span class="ot">&lt;-</span><span class="fu">extractHR</span>(DFS_step)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Cox_step_dfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         HR  lcl  ucl     p
Any_TA 1.46 0.94 2.25 0.091
Vi1    1.63 1.03 2.58 0.038
MULTI4 1.92 1.16 3.18 0.011
CEA73  1.59 0.88 2.87 0.122</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Cox_step_dfs, <span class="at">file=</span><span class="st">"Cox_step_DFS.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>TS_OS<span class="ot">=</span><span class="fu">Surv</span>(HAN<span class="sc">$</span>FU_OS, HAN<span class="sc">$</span>DEATH<span class="sc">==</span><span class="dv">1</span>) <span class="co">#time object</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fit_OS <span class="ot">&lt;-</span><span class="fu">survfit</span>(HAN<span class="sc">$</span>TS_OS<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>out_u_os<span class="ot">=</span><span class="fu">mycph</span>(TS_OS<span class="sc">~</span>Adju_TA<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">++</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD, <span class="at">data=</span>HAN) <span class="co"># Univariate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 mycph : perform coxph of individual expecting variables

 Call: TS_OS ~ Adju_TA + SEX + AGE60 + CCI7 + RTCOL + +LNR + pT4 + Pni1 +     Lvi1 + Vi1 + PD, data= HAN </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>out_u_os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            HR  lcl  ucl     p
Adju_TA   1.37 0.82 2.28 0.227
SEX       1.10 0.65 1.88 0.716
AGE60     1.23 0.76 1.99 0.394
CCI7CCI&gt;7 1.13 0.70 1.83 0.613
RTCOL     1.14 0.63 2.06 0.655
LNR       1.64 0.46 5.86 0.449
pT4       1.39 0.74 2.59 0.304
Pni1      1.20 0.74 1.96 0.453
Lvi1      0.81 0.49 1.34 0.407
Vi1       1.80 1.09 2.99 0.023
PD        0.98 0.24 4.02 0.979</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>out_m_os<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_OS<span class="sc">~</span>Adju_TA<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">++</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD, <span class="at">data=</span>HAN)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(out_m_os)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            HR  lcl   ucl     p
Adju_TA   1.38 0.81  2.35 0.232
SEX       1.12 0.64  1.93 0.697
AGE60     2.27 0.30 16.89 0.424
CCI7CCI&gt;7 0.49 0.07  3.71 0.491
RTCOL     1.02 0.55  1.90 0.943
LNR       1.69 0.41  6.92 0.463
pT4       1.30 0.65  2.58 0.462
Pni1      1.06 0.62  1.81 0.839
Lvi1      0.63 0.35  1.12 0.113
Vi1       2.01 1.11  3.66 0.022
PD        0.78 0.17  3.55 0.748</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survminer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>DFS_all<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>HAN)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(FU_DFS, RECUR == "1") ~ 1, data = HAN)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1    137       3    0.978  0.0125        0.954        1.000
    2    133       1    0.971  0.0144        0.943        0.999
    3    131       7    0.919  0.0235        0.874        0.966
    4    123       3    0.896  0.0262        0.847        0.949
    5    119       2    0.881  0.0278        0.828        0.938
    6    117       3    0.859  0.0300        0.802        0.920
    7    114       3    0.836  0.0320        0.776        0.901
    8    110       4    0.806  0.0342        0.741        0.876
    9    105       6    0.760  0.0371        0.690        0.836
   10     96       4    0.728  0.0388        0.656        0.808
   11     92       5    0.689  0.0405        0.614        0.773
   12     86       8    0.624  0.0426        0.546        0.714
   13     77       4    0.592  0.0434        0.513        0.683
   14     73       6    0.543  0.0441        0.463        0.637
   15     65       3    0.518  0.0444        0.438        0.613
   17     62       3    0.493  0.0445        0.413        0.589
   18     58       1    0.485  0.0446        0.405        0.580
   19     56       2    0.467  0.0446        0.388        0.564
   20     53       4    0.432  0.0446        0.353        0.529
   21     49       1    0.423  0.0446        0.344        0.520
   23     47       1    0.414  0.0445        0.336        0.511
   24     46       3    0.387  0.0443        0.310        0.485
   26     42       1    0.378  0.0442        0.301        0.475
   27     41       1    0.369  0.0440        0.292        0.466
   28     40       3    0.341  0.0435        0.266        0.438
   36     37       1    0.332  0.0433        0.257        0.429
   43     36       1    0.323  0.0431        0.248        0.419
   69     20       1    0.307  0.0439        0.232        0.406</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(HAN<span class="sc">$</span>FU_DFS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(HAN<span class="sc">$</span>FU_DFS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 161</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(HAN<span class="sc">$</span>FU_DFS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(HAN<span class="sc">$</span>FU_OS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(HAN<span class="sc">$</span>FU_OS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(HAN<span class="sc">$</span>FU_OS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(HAN<span class="sc">$</span>RECUR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(HAN<span class="sc">$</span>DEATH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>DFS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(FU_DFS, RECUR == "1") ~ Adju_TA, data = HAN)

                Adju_TA=0 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     76       1    0.987  0.0131        0.962        1.000
    2     74       1    0.974  0.0185        0.938        1.000
    3     72       3    0.933  0.0290        0.878        0.991
    4     69       3    0.892  0.0360        0.825        0.966
    5     65       2    0.865  0.0397        0.790        0.946
    6     63       1    0.851  0.0414        0.774        0.936
    7     62       1    0.837  0.0430        0.757        0.926
    8     61       3    0.796  0.0470        0.709        0.894
    9     57       2    0.768  0.0493        0.678        0.871
   10     54       4    0.711  0.0532        0.614        0.824
   11     50       1    0.697  0.0540        0.599        0.812
   12     48       2    0.668  0.0556        0.568        0.786
   13     46       2    0.639  0.0568        0.537        0.761
   14     44       4    0.581  0.0586        0.477        0.708
   15     40       1    0.566  0.0589        0.462        0.695
   17     39       1    0.552  0.0592        0.447        0.681
   18     38       1    0.537  0.0594        0.433        0.667
   19     36       2    0.508  0.0597        0.403        0.639
   20     34       1    0.493  0.0598        0.388        0.625
   23     33       1    0.478  0.0598        0.374        0.611
   24     32       2    0.448  0.0597        0.345        0.582
   28     30       2    0.418  0.0593        0.317        0.552
   36     28       1    0.403  0.0590        0.302        0.537
   69     18       1    0.381  0.0599        0.280        0.518

                Adju_TA=1 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     61       2    0.967  0.0228        0.924        1.000
    3     59       4    0.902  0.0381        0.830        0.980
    6     54       2    0.868  0.0434        0.787        0.958
    7     52       2    0.835  0.0477        0.746        0.934
    8     49       1    0.818  0.0497        0.726        0.921
    9     48       4    0.750  0.0560        0.647        0.868
   11     42       4    0.678  0.0610        0.569        0.809
   12     38       6    0.571  0.0652        0.457        0.714
   13     31       2    0.534  0.0660        0.419        0.681
   14     29       2    0.497  0.0664        0.383        0.646
   15     25       2    0.458  0.0668        0.344        0.609
   17     23       2    0.418  0.0666        0.306        0.571
   20     19       3    0.352  0.0661        0.243        0.509
   21     16       1    0.330  0.0655        0.224        0.487
   24     14       1    0.306  0.0650        0.202        0.464
   26     12       1    0.281  0.0644        0.179        0.440
   27     11       1    0.255  0.0634        0.157        0.415
   28     10       1    0.230  0.0620        0.135        0.390
   43      9       1    0.204  0.0601        0.115        0.364</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>DFS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(FU_DFS, RECUR == "1") ~ Adju_TA, data = HAN)

           n events median 0.95LCL 0.95UCL
Adju_TA=0 77     43     20      14      NA
Adju_TA=1 61     42     14      12      21</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>DFS_target_kind<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_target, <span class="at">data=</span>HAN)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS_target_kind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(FU_DFS, RECUR == "1") ~ Adju_target, data = HAN)

                Adju_target=0 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     76       1    0.987  0.0131        0.962        1.000
    2     74       1    0.974  0.0185        0.938        1.000
    3     72       3    0.933  0.0290        0.878        0.991
    4     69       3    0.892  0.0360        0.825        0.966
    5     65       2    0.865  0.0397        0.790        0.946
    6     63       1    0.851  0.0414        0.774        0.936
    7     62       1    0.837  0.0430        0.757        0.926
    8     61       3    0.796  0.0470        0.709        0.894
    9     57       2    0.768  0.0493        0.678        0.871
   10     54       4    0.711  0.0532        0.614        0.824
   11     50       1    0.697  0.0540        0.599        0.812
   12     48       2    0.668  0.0556        0.568        0.786
   13     46       2    0.639  0.0568        0.537        0.761
   14     44       4    0.581  0.0586        0.477        0.708
   15     40       1    0.566  0.0589        0.462        0.695
   17     39       1    0.552  0.0592        0.447        0.681
   18     38       1    0.537  0.0594        0.433        0.667
   19     36       2    0.508  0.0597        0.403        0.639
   20     34       1    0.493  0.0598        0.388        0.625
   23     33       1    0.478  0.0598        0.374        0.611
   24     32       2    0.448  0.0597        0.345        0.582
   28     30       2    0.418  0.0593        0.317        0.552
   36     28       1    0.403  0.0590        0.302        0.537
   69     18       1    0.381  0.0599        0.280        0.518

                Adju_target=1 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     42       2    0.952  0.0329        0.890        1.000
    3     40       3    0.881  0.0500        0.788        0.985
    6     37       1    0.857  0.0540        0.758        0.970
    7     36       2    0.810  0.0606        0.699        0.937
    8     34       1    0.786  0.0633        0.671        0.920
    9     33       1    0.762  0.0657        0.643        0.902
   11     31       3    0.688  0.0718        0.561        0.844
   12     28       4    0.590  0.0766        0.457        0.761
   13     24       1    0.565  0.0772        0.433        0.739
   15     21       2    0.511  0.0787        0.378        0.691
   17     19       2    0.458  0.0791        0.326        0.642
   20     15       2    0.397  0.0794        0.268        0.587
   21     13       1    0.366  0.0790        0.240        0.559
   24     12       1    0.336  0.0781        0.213        0.529
   27     11       1    0.305  0.0767        0.186        0.499
   28     10       1    0.275  0.0748        0.161        0.468
   43      9       1    0.244  0.0725        0.136        0.437

                Adju_target=2 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    3     19       1    0.947  0.0512       0.8521        1.000
    6     17       1    0.892  0.0724       0.7604        1.000
    9     15       3    0.713  0.1088       0.5290        0.962
   11     11       1    0.648  0.1166       0.4558        0.923
   12     10       2    0.519  0.1242       0.3244        0.830
   13      7       1    0.445  0.1267       0.2544        0.777
   14      6       2    0.296  0.1202       0.1339        0.656
   20      4       1    0.222  0.1107       0.0838        0.590
   26      1       1    0.000     NaN           NA           NA</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(DFS_target_kind, <span class="at">main=</span><span class="st">"Progression free survival, Kind of target agent"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"Survival Probability"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>,<span class="st">"green"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"None"</span>,<span class="st">"Bevacizumab"</span>,<span class="st">"Cetuximab"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>,<span class="st">"green"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>PFS_target_kind<span class="ot">&lt;-</span><span class="fu">ggsurvplot</span>(DFS_target_kind, </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval=</span><span class="cn">TRUE</span>, </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">break.time.by =</span> <span class="dv">12</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(<span class="st">"None"</span>, <span class="st">"Bevacizumab"</span>,<span class="st">"Cetuximab"</span>))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>PFS_target_kind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>PFS<span class="ot">&lt;-</span><span class="fu">ggsurvplot</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  DFS,                     <span class="co"># survfit object with calculated statistics.</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,        <span class="co"># show confidence intervals for </span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># point estimaes of survival curves.</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int.style =</span> <span class="st">"step"</span>,  <span class="co"># customize style of confidence intervals</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in months"</span>,   <span class="co"># customize X axis label.</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">12</span>,     <span class="co"># break X axis in time intervals by 200.</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_light</span>(), <span class="co"># customize plot and risk table with a theme.</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="st">"abs_pct"</span>,  <span class="co"># absolute number and percentage at risk.</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text.col =</span> T,<span class="co"># colour risk table text annotations.</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text =</span> <span class="cn">FALSE</span>,<span class="co"># show bars instead of names in text annotations</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in legend of risk table.</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncensor.plot =</span> <span class="cn">FALSE</span>,      <span class="co"># plot the number of censored subjects at time t</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#surv.median.line = "hv",  # add the median survival pointer.</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Adjuvant target agent, No"</span>, <span class="st">"Yes"</span>),    <span class="co"># change legend labels.</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>), <span class="co"># custom color palettes.</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cn">NULL</span>, <span class="co">#Cumulative risk</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">72</span>)</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>PFS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>OS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_OS, DEATH<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>OS_all<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_OS, DEATH<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>HAN)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(OS_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(FU_OS, DEATH == "1") ~ 1, data = HAN)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1    138       1    0.993 0.00722        0.979        1.000
    4    137       1    0.986 0.01017        0.966        1.000
    9    135       1    0.978 0.01244        0.954        1.000
   10    133       1    0.971 0.01436        0.943        0.999
   13    132       1    0.963 0.01603        0.933        0.995
   14    130       2    0.949 0.01890        0.912        0.986
   16    126       2    0.934 0.02139        0.893        0.976
   18    122       2    0.918 0.02362        0.873        0.966
   19    120       1    0.911 0.02463        0.864        0.960
   20    118       1    0.903 0.02560        0.854        0.955
   23    114       1    0.895 0.02657        0.844        0.949
   24    112       2    0.879 0.02840        0.825        0.937
   25    110       3    0.855 0.03082        0.797        0.918
   27    107       2    0.839 0.03224        0.778        0.905
   28    105       2    0.823 0.03355        0.760        0.892
   29    103       3    0.799 0.03532        0.733        0.871
   30     97       2    0.783 0.03646        0.714        0.857
   31     94       2    0.766 0.03754        0.696        0.843
   32     90       1    0.757 0.03807        0.686        0.836
   34     88       2    0.740 0.03910        0.667        0.821
   35     85       1    0.732 0.03960        0.658        0.813
   36     84       1    0.723 0.04008        0.648        0.806
   37     83       1    0.714 0.04053        0.639        0.798
   38     82       3    0.688 0.04176        0.611        0.775
   39     78       2    0.670 0.04251        0.592        0.759
   40     76       1    0.662 0.04286        0.583        0.751
   41     75       2    0.644 0.04349        0.564        0.735
   43     72       1    0.635 0.04380        0.555        0.727
   45     71       1    0.626 0.04408        0.545        0.719
   46     69       1    0.617 0.04437        0.536        0.710
   49     67       2    0.599 0.04492        0.517        0.693
   52     62       2    0.579 0.04549        0.497        0.676
   53     60       2    0.560 0.04598        0.477        0.658
   60     55       1    0.550 0.04626        0.466        0.648
   64     54       1    0.540 0.04651        0.456        0.639
   67     52       1    0.529 0.04676        0.445        0.629
   71     50       1    0.519 0.04700        0.434        0.619
   73     47       1    0.508 0.04728        0.423        0.609
   76     42       1    0.495 0.04767        0.410        0.598
   79     41       1    0.483 0.04802        0.398        0.587
   88     40       1    0.471 0.04832        0.386        0.576
   89     39       1    0.459 0.04856        0.373        0.565
   94     37       1    0.447 0.04881        0.361        0.553
  105     31       1    0.432 0.04932        0.346        0.541
  107     29       1    0.417 0.04982        0.330        0.528
  110     26       1    0.401 0.05043        0.314        0.513
  120     21       1    0.382 0.05152        0.294        0.498</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OS</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>OS_TA<span class="ot">&lt;-</span><span class="fu">ggsurvplot</span>(</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  OS,                     <span class="co"># survfit object with calculated statistics.</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,        <span class="co"># show confidence intervals for </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># point estimaes of survival curves.</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int.style =</span> <span class="st">"step"</span>,  <span class="co"># customize style of confidence intervals</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in months"</span>,   <span class="co"># customize X axis label.</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">12</span>,     <span class="co"># break X axis in time intervals by 200.</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_light</span>(), <span class="co"># customize plot and risk table with a theme.</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="st">"abs_pct"</span>,  <span class="co"># absolute number and percentage at risk.</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text.col =</span> T,<span class="co"># colour risk table text annotations.</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text =</span> <span class="cn">FALSE</span>,<span class="co"># show bars instead of names in text annotations</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in legend of risk table.</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncensor.plot =</span> <span class="cn">FALSE</span>,      <span class="co"># plot the number of censored subjects at time t</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#surv.median.line = "hv",  # add the median survival pointer.</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Adjuvant target agent, No"</span>, <span class="st">"Yes"</span>),    <span class="co"># change legend labels.</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>), <span class="co"># custom color palettes.</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cn">NULL</span>, <span class="co">#Cumulative risk</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">72</span>)</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>OS_TA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MatchIt)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(HAN[,<span class="fu">c</span>(<span class="st">"MRN"</span>,<span class="st">"Adju_TA"</span>,<span class="st">"Adju_target"</span>,<span class="st">"Male"</span>,<span class="st">"AGE60"</span>,<span class="st">"CCI7"</span>,<span class="st">"ASA3"</span>,<span class="st">"RTCOL"</span>,<span class="st">"LNR"</span>,<span class="st">"pT4"</span>,<span class="st">"Pni1"</span>,<span class="st">"Lvi1"</span>,<span class="st">"Vi1"</span>,<span class="st">"PD"</span>,<span class="st">"BILOBE"</span>,<span class="st">"MULTI4"</span>,<span class="st">"SIZE4"</span>,<span class="st">"CEA73"</span>,<span class="st">"M1_12m"</span>,<span class="st">"PreHR_chemo"</span>,<span class="st">"PreHR_TA"</span>,<span class="st">"FU_DFS"</span>,<span class="st">"RECUR"</span>)])</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="do">## DATA character change </span><span class="al">###</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Male <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Male)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>AGE60 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>AGE60)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>CCI7 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>CCI7)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  HAN_IPTW$ASA3 &lt;-as.factor(HAN_IPTW$CCI7) # 오타를 수정하여 아래와 같이 변경함 '24.07.31</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>ASA3 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>ASA3)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>RTCOL <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>RTCOL)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>pT4 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>pT4)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Pni1 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Pni1)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Lvi1 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Lvi1)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Vi1 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Vi1)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>PD <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>PD)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>BILOBE <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>BILOBE)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>MULTI4 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>MULTI4)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>SIZE4 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>SIZE4)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>CEA73 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>CEA73)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>M1_12m <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>M1_12m)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>PreHR_TA <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>PreHR_TA)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>table1_iptw <span class="ot">&lt;-</span> <span class="fu">mytable</span>(Adju_TA<span class="sc">~</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA,</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show.total=</span><span class="cn">TRUE</span>, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">data=</span>HAN_IPTW, <span class="at">method =</span> <span class="dv">3</span>)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>table1_iptw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                 Descriptive Statistics by 'Adju_TA'                
————————————————————————————————————————————————————————————————————— 
                    0                1              Total         p  
                  (N=77)           (N=61)          (N=138)     
————————————————————————————————————————————————————————————————————— 
 Adju_target                                                    0.000
   - 0         77 (100.0%)        0 ( 0.0%)       77 (55.8%)         
   - 1           0 ( 0.0%)       42 (68.9%)       42 (30.4%)         
   - 2           0 ( 0.0%)       19 (31.1%)       19 (13.8%)         
 Male                                                           0.888
   - 0          22 (28.6%)       19 (31.1%)       41 (29.7%)         
   - 1          55 (71.4%)       42 (68.9%)       97 (70.3%)         
 AGE60                                                          1.000
   - 0          40 (51.9%)       31 (50.8%)       71 (51.4%)         
   - 1          37 (48.1%)       30 (49.2%)       67 (48.6%)         
 CCI7                                                           1.000
   - CCI&lt;7      37 (48.1%)       29 (47.5%)       66 (47.8%)         
   - CCI&gt;7      40 (51.9%)       32 (52.5%)       72 (52.2%)         
 ASA3                                                           0.382
   - 0          60 (77.9%)       52 (85.2%)      112 (81.2%)         
   - 1          17 (22.1%)       9 (14.8%)        26 (18.8%)         
 RTCOL                                                          0.961
   - 0          63 (81.8%)       51 (83.6%)      114 (82.6%)         
   - 1          14 (18.2%)       10 (16.4%)       24 (17.4%)         
 LNR          0.1 [ 0.0; 0.2]  0.1 [ 0.0; 0.3]  0.1 [ 0.0; 0.3] 0.476
 pT4                                                            0.211
   - 0          64 (83.1%)       56 (91.8%)      120 (87.0%)         
   - 1          13 (16.9%)       5 ( 8.2%)        18 (13.0%)         
 Pni1                                                           0.599
   - 0          46 (59.7%)       40 (65.6%)       86 (62.3%)         
   - 1          31 (40.3%)       21 (34.4%)       52 (37.7%)         
 Lvi1                                                           0.032
   - 0          42 (54.5%)       45 (73.8%)       87 (63.0%)         
   - 1          35 (45.5%)       16 (26.2%)       51 (37.0%)         
 Vi1                                                            0.619
   - 0          54 (70.1%)       46 (75.4%)      100 (72.5%)         
   - 1          23 (29.9%)       15 (24.6%)       38 (27.5%)         
 PD                                                             1.000
   - 0          74 (96.1%)       58 (95.1%)      132 (95.7%)         
   - 1          3 ( 3.9%)        3 ( 4.9%)        6 ( 4.3%)          
 BILOBE                                                         0.468
   - 0          46 (59.7%)       41 (67.2%)       87 (63.0%)         
   - 1          31 (40.3%)       20 (32.8%)       51 (37.0%)         
 MULTI4                                                         0.183
   - 0          65 (84.4%)       45 (73.8%)      110 (79.7%)         
   - 1          12 (15.6%)       16 (26.2%)       28 (20.3%)         
 SIZE4                                                          0.392
   - 0          66 (85.7%)       48 (78.7%)      114 (82.6%)         
   - 1          11 (14.3%)       13 (21.3%)       24 (17.4%)         
 CEA73                                                          0.445
   - 0          70 (90.9%)       52 (85.2%)      122 (88.4%)         
   - 1          7 ( 9.1%)        9 (14.8%)        16 (11.6%)         
 M1_12m                                                         0.025
   - M0         7 ( 9.1%)        15 (24.6%)       22 (15.9%)         
   - M1         70 (90.9%)       46 (75.4%)      116 (84.1%)         
 PreHR_TA                                                       0.000
   - 0          75 (97.4%)       40 (65.6%)      115 (83.3%)         
   - 1          2 ( 2.6%)        21 (34.4%)       23 (16.7%)         
————————————————————————————————————————————————————————————————————— </code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#로지스틱 회귀분석</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fit_IPTW<span class="ot">&lt;-</span><span class="fu">glm</span>(Adju_TA<span class="sc">~</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA, <span class="at">family=</span>binomial, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>factor<span class="ot">&lt;-</span><span class="fu">extractOR</span>(fit_IPTW, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>factor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                OR   lcl     ucl      p
(Intercept)  1.947 0.421   8.997 0.3937
Male1        0.895 0.352   2.280 0.8167
AGE601       0.978 0.400   2.395 0.9618
ASA31        0.521 0.161   1.688 0.2771
RTCOL1       1.609 0.531   4.878 0.4008
LNR          3.870 0.334  44.827 0.2789
pT41         0.511 0.145   1.798 0.2953
Pni11        1.288 0.500   3.322 0.6002
Lvi11        0.492 0.183   1.326 0.1609
Vi11         1.513 0.554   4.134 0.4189
PD1          0.876 0.110   6.954 0.9001
BILOBE1      0.353 0.112   1.112 0.0753
MULTI41      4.117 1.093  15.505 0.0365
SIZE41       1.568 0.494   4.980 0.4454
CEA731       1.424 0.359   5.643 0.6150
M1_12mM1     0.200 0.056   0.713 0.0130
PreHR_TA1   25.136 4.707 134.241 0.0002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_IPTW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Adju_TA ~ Male + AGE60 + ASA3 + RTCOL + LNR + pT4 + 
    Pni1 + Lvi1 + Vi1 + PD + BILOBE + MULTI4 + SIZE4 + CEA73 + 
    M1_12m + PreHR_TA, family = binomial, data = HAN_IPTW)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.66612    0.78103   0.853 0.393731    
Male1       -0.11054    0.47685  -0.232 0.816686    
AGE601      -0.02185    0.45677  -0.048 0.961850    
ASA31       -0.65184    0.59971  -1.087 0.277067    
RTCOL1       0.47552    0.56593   0.840 0.400772    
LNR          1.35323    1.24981   1.083 0.278922    
pT41        -0.67226    0.64234  -1.047 0.295296    
Pni11        0.25326    0.48328   0.524 0.600239    
Lvi11       -0.70934    0.50596  -1.402 0.160925    
Vi11         0.41442    0.51266   0.808 0.418878    
PD1         -0.13265    1.05712  -0.125 0.900139    
BILOBE1     -1.04039    0.58489  -1.779 0.075276 .  
MULTI41      1.41516    0.67655   2.092 0.036463 *  
SIZE41       0.44987    0.58957   0.763 0.445433    
CEA731       0.35335    0.70262   0.503 0.615034    
M1_12mM1    -1.60732    0.64726  -2.483 0.013018 *  
PreHR_TA1    3.22432    0.85477   3.772 0.000162 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 189.45  on 137  degrees of freedom
Residual deviance: 141.76  on 121  degrees of freedom
AIC: 175.76

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(factor, <span class="at">file=</span><span class="st">"fit_PTR.csv"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>pr.score <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_IPTW, <span class="at">type =</span> <span class="st">"response"</span>) <span class="do">##attach propensity score##</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co">#HAN_IPTW$att.weights &lt;- with(HAN_IPTW, Adju_TA + (1-Adju_TA)*pr.score/(1-pr.score))</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>ate.weights <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(HAN_IPTW<span class="sc">$</span>Adju_TA<span class="sc">==</span><span class="st">"1"</span>, <span class="dv">1</span><span class="sc">/</span>HAN_IPTW<span class="sc">$</span>pr.score, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>HAN_IPTW<span class="sc">$</span>pr.score))</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Goodness of Fit test, Hosmer Lemeshow test ####</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ResourceSelection")</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ResourceSelection 0.3-6      2023-06-27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(HAN_IPTW<span class="sc">$</span>Adju_TA, <span class="fu">fitted</span>(fit_IPTW)) <span class="co">#p 높으면 적합</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  HAN_IPTW$Adju_TA, fitted(fit_IPTW)
X-squared = 4.1557, df = 8, p-value = 0.8428</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(Epi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Epi</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## discrimination of TA NO vs. TA YES group by propensity score ##</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">=</span><span class="fu">ROC</span>(<span class="at">form=</span>Adju_TA<span class="sc">~</span>pr.score, <span class="at">data=</span>HAN_IPTW, <span class="at">plot =</span> <span class="st">"ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="index_files/figure-html/PSM-ROC-curve-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/PSM-ROC-curve-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (WeightIt)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cobalt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> cobalt (Version 4.5.5, Build Date: 2024-04-02)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cobalt'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatchIt':

    lalonde</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>covs <span class="ot">&lt;-</span> <span class="fu">subset</span>(HAN_IPTW, <span class="at">select =</span> <span class="fu">c</span>(Male,AGE60,ASA3,RTCOL,LNR,pT4,Pni1,Lvi1,Vi1,PD,BILOBE,MULTI4,SIZE4,CEA73,M1_12m,PreHR_TA))</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co">#W.out_att &lt;- weightit(Adju_TA~covs, data=HAN_IPTW, method="ps", estimand = "ATT") ##table#</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">#bal.tab(W.out_att, un=TRUE, binary="std", thresholds=0.2)</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>W.out_ate <span class="ot">&lt;-</span> <span class="fu">weightit</span>(Adju_TA<span class="sc">~</span>covs, <span class="at">data=</span>HAN_IPTW, <span class="at">method=</span><span class="st">"ps"</span>, <span class="at">estimand =</span> <span class="st">"ATE"</span>) <span class="do">##table#</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(W.out_ate, <span class="at">un=</span><span class="cn">TRUE</span>, <span class="at">binary=</span><span class="st">"std"</span>, <span class="at">thresholds=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Balance Measures
               Type Diff.Un Diff.Adj        M.Threshold
prop.score Distance  1.2948   0.0954     Balanced, &lt;0.2
Male         Binary -0.0563  -0.0633     Balanced, &lt;0.2
AGE60        Binary  0.0226   0.0551     Balanced, &lt;0.2
ASA3         Binary -0.1898  -0.2252 Not Balanced, &gt;0.2
RTCOL        Binary -0.0473  -0.0140     Balanced, &lt;0.2
LNR         Contin. -0.0224  -0.0010     Balanced, &lt;0.2
pT4          Binary -0.2646  -0.0027     Balanced, &lt;0.2
Pni1         Binary -0.1208   0.0059     Balanced, &lt;0.2
Lvi1         Binary -0.4092  -0.0375     Balanced, &lt;0.2
Vi1          Binary -0.1188   0.0237     Balanced, &lt;0.2
PD           Binary  0.0498  -0.0369     Balanced, &lt;0.2
BILOBE       Binary -0.1557   0.0862     Balanced, &lt;0.2
MULTI4       Binary  0.2641   0.0769     Balanced, &lt;0.2
SIZE4        Binary  0.1845   0.0546     Balanced, &lt;0.2
CEA73        Binary  0.1754   0.0483     Balanced, &lt;0.2
M1_12m_M1    Binary -0.4233  -0.0917     Balanced, &lt;0.2
PreHR_TA     Binary  0.8984   0.0531     Balanced, &lt;0.2

Balance tally for mean differences
                   count
Balanced, &lt;0.2        16
Not Balanced, &gt;0.2     1

Variable with the greatest mean difference
 Variable Diff.Adj        M.Threshold
     ASA3  -0.2252 Not Balanced, &gt;0.2

Effective sample sizes
           Control Treated
Unadjusted      77   61.  
Adjusted        46   40.54</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the variable names mapping</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">old =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"AGE60"</span>, <span class="st">"ASA3"</span>, <span class="st">"RTCOL"</span>, <span class="st">"LNR"</span>, <span class="st">"pT4"</span>, <span class="st">"Pni1"</span>, <span class="st">"Lvi1"</span>, <span class="st">"Vi1"</span>, <span class="st">"PD"</span>, <span class="st">"BILOBE"</span>, <span class="st">"MULTI4"</span>, <span class="st">"SIZE4"</span>, <span class="st">"CEA73"</span>, <span class="st">"M1_12m"</span>, <span class="st">"PreHR_TA"</span>, <span class="st">"ps"</span>),</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Age&gt;60"</span>, <span class="st">"ASA &gt;3"</span>, <span class="st">"Primary tumor at Rt colon"</span>, <span class="st">"Regional LN ratio"</span>, <span class="st">"pT4"</span>, <span class="st">"Perineural invasion of PT"</span>, <span class="st">"Lymphatic invasion of PT"</span>, <span class="st">"Vascular invasion of PT"</span>, <span class="st">"Poor differentiated"</span>, <span class="st">"Bilobar involvement of CRLM"</span>, <span class="st">"Number of CRLM&gt;4"</span>, <span class="st">"Max size of CRLM&gt;4cm"</span>, <span class="st">"Pre-hepatectomy CEA&gt;73"</span>, <span class="st">"Synch or LM within 12mon"</span>, <span class="st">"Neoaduvant target agent"</span>, <span class="st">"propensity score"</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Love Plot and save it to a variable</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>love_plot <span class="ot">&lt;-</span> <span class="fu">love.plot</span>(</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  W.out_ate,</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean.diffs"</span>), </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">threshold =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">2</span>), </span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">binary =</span> <span class="st">"std"</span>, </span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">abs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.order =</span> <span class="st">"unadjusted"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.names =</span> v,</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> <span class="cn">TRUE</span>, </span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="dv">20</span>,</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.names =</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Weighted"</span>),</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shapes =</span> <span class="fu">c</span>(<span class="st">"circle"</span>, <span class="st">"triangle"</span>),</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Absolute standardized mean difference"</span>) <span class="sc">+</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">3</span>),</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the love_plot variable to display the plot</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(love_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [25]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tableone)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survey'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:WeightIt':

    calibrate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    dotchart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"AGE60"</span>,<span class="st">"ASA3"</span>,<span class="st">"RTCOL"</span>,<span class="st">"LNR"</span>,<span class="st">"pT4"</span>,<span class="st">"Pni1"</span>,<span class="st">"Lvi1"</span>,<span class="st">"Vi1"</span>,<span class="st">"PD"</span>,<span class="st">"BILOBE"</span>,<span class="st">"MULTI4"</span>,<span class="st">"SIZE4"</span>,<span class="st">"CEA73"</span>,<span class="st">"M1_12m"</span>,<span class="st">"PreHR_TA"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>tab.unwt <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars=</span>vars, <span class="at">strata=</span><span class="st">"Adju_TA"</span>, <span class="at">data=</span>HAN_IPTW, <span class="at">test =</span><span class="cn">FALSE</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab.unwt, <span class="at">smd=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Stratified by Adju_TA
                   0            1            SMD   
  n                  77           61               
  Male = 1 (%)       55 (71.4)    42 (68.9)   0.056
  AGE60 = 1 (%)      37 (48.1)    30 (49.2)   0.023
  ASA3 = 1 (%)       17 (22.1)     9 (14.8)   0.190
  RTCOL = 1 (%)      14 (18.2)    10 (16.4)   0.047
  LNR (mean (SD))  0.18 (0.20)  0.17 (0.22)   0.022
  pT4 = 1 (%)        13 (16.9)     5 ( 8.2)   0.265
  Pni1 = 1 (%)       31 (40.3)    21 (34.4)   0.121
  Lvi1 = 1 (%)       35 (45.5)    16 (26.2)   0.409
  Vi1 = 1 (%)        23 (29.9)    15 (24.6)   0.119
  PD = 1 (%)          3 ( 3.9)     3 ( 4.9)   0.050
  BILOBE = 1 (%)     31 (40.3)    20 (32.8)   0.156
  MULTI4 = 1 (%)     12 (15.6)    16 (26.2)   0.264
  SIZE4 = 1 (%)      11 (14.3)    13 (21.3)   0.184
  CEA73 = 1 (%)       7 ( 9.1)     9 (14.8)   0.175
  M1_12m = M1 (%)    70 (90.9)    46 (75.4)   0.423
  PreHR_TA = 1 (%)    2 ( 2.6)    21 (34.4)   0.898</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>Svy <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> HAN_IPTW, <span class="at">weights =</span> <span class="sc">~</span> ate.weights)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Svy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Independent Sampling design (with replacement)
svydesign(ids = ~1, data = HAN_IPTW, weights = ~ate.weights)
Probabilities:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.09763 0.48219 0.70622 0.65764 0.82555 0.98896 
Data variables:
 [1] "MRN"         "Adju_TA"     "Adju_target" "Male"        "AGE60"      
 [6] "CCI7"        "ASA3"        "RTCOL"       "LNR"         "pT4"        
[11] "Pni1"        "Lvi1"        "Vi1"         "PD"          "BILOBE"     
[16] "MULTI4"      "SIZE4"       "CEA73"       "M1_12m"      "PreHR_chemo"
[21] "PreHR_TA"    "FU_DFS"      "RECUR"       "pr.score"    "ate.weights"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>Svy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Independent Sampling design (with replacement)
svydesign(ids = ~1, data = HAN_IPTW, weights = ~ate.weights)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>tab.wt <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(<span class="at">vars=</span>vars, <span class="at">strata=</span><span class="st">"Adju_TA"</span>, <span class="at">data=</span>Svy, <span class="at">test =</span><span class="cn">FALSE</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab.wt, <span class="at">smd=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Stratified by Adju_TA
                   0              1              SMD   
  n                 132.9          137.7               
  Male = 1 (%)       89.5 (67.4)    88.8 (64.5)   0.061
  AGE60 = 1 (%)      57.5 (43.3)    63.4 (46.0)   0.055
  ASA3 = 1 (%)       39.6 (29.8)    29.0 (21.1)   0.201
  RTCOL = 1 (%)      22.9 (17.3)    23.1 (16.7)   0.014
  LNR (mean (SD))    0.17 (0.19)    0.17 (0.21)   0.001
  pT4 = 1 (%)        17.9 (13.5)    18.4 (13.4)   0.003
  Pni1 = 1 (%)       53.4 (40.2)    55.7 (40.4)   0.006
  Lvi1 = 1 (%)       47.0 (35.4)    46.3 (33.6)   0.037
  Vi1 = 1 (%)        36.4 (27.4)    39.2 (28.4)   0.024
  PD = 1 (%)          6.0 ( 4.5)     5.1 ( 3.7)   0.038
  BILOBE = 1 (%)     42.9 (32.3)    50.2 (36.4)   0.087
  MULTI4 = 1 (%)     19.9 (15.0)    24.9 (18.1)   0.084
  SIZE4 = 1 (%)      29.4 (22.1)    33.3 (24.2)   0.049
  CEA73 = 1 (%)      11.3 ( 8.5)    13.9 (10.1)   0.054
  M1_12m = M1 (%)   116.2 (87.4)   115.8 (84.1)   0.096
  PreHR_TA = 1 (%)   19.8 (14.9)    23.2 (16.8)   0.051</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jskm)   </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>unadjusteDFS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(HAN_IPTW<span class="sc">$</span>FU_DFS, <span class="fu">as.numeric</span>(HAN_IPTW<span class="sc">$</span>RECUR)) <span class="sc">~</span> HAN_IPTW<span class="sc">$</span>Adju_TA, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(unadjusteDFS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(HAN_IPTW$FU_DFS, as.numeric(HAN_IPTW$RECUR)) ~ 
    HAN_IPTW$Adju_TA, data = HAN_IPTW)

                HAN_IPTW$Adju_TA=0 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     76       1    0.987  0.0131        0.962        1.000
    2     74       1    0.974  0.0185        0.938        1.000
    3     72       3    0.933  0.0290        0.878        0.991
    4     69       3    0.892  0.0360        0.825        0.966
    5     65       2    0.865  0.0397        0.790        0.946
    6     63       1    0.851  0.0414        0.774        0.936
    7     62       1    0.837  0.0430        0.757        0.926
    8     61       3    0.796  0.0470        0.709        0.894
    9     57       2    0.768  0.0493        0.678        0.871
   10     54       4    0.711  0.0532        0.614        0.824
   11     50       1    0.697  0.0540        0.599        0.812
   12     48       2    0.668  0.0556        0.568        0.786
   13     46       2    0.639  0.0568        0.537        0.761
   14     44       4    0.581  0.0586        0.477        0.708
   15     40       1    0.566  0.0589        0.462        0.695
   17     39       1    0.552  0.0592        0.447        0.681
   18     38       1    0.537  0.0594        0.433        0.667
   19     36       2    0.508  0.0597        0.403        0.639
   20     34       1    0.493  0.0598        0.388        0.625
   23     33       1    0.478  0.0598        0.374        0.611
   24     32       2    0.448  0.0597        0.345        0.582
   28     30       2    0.418  0.0593        0.317        0.552
   36     28       1    0.403  0.0590        0.302        0.537
   69     18       1    0.381  0.0599        0.280        0.518

                HAN_IPTW$Adju_TA=1 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     61       2    0.967  0.0228        0.924        1.000
    3     59       4    0.902  0.0381        0.830        0.980
    6     54       2    0.868  0.0434        0.787        0.958
    7     52       2    0.835  0.0477        0.746        0.934
    8     49       1    0.818  0.0497        0.726        0.921
    9     48       4    0.750  0.0560        0.647        0.868
   11     42       4    0.678  0.0610        0.569        0.809
   12     38       6    0.571  0.0652        0.457        0.714
   13     31       2    0.534  0.0660        0.419        0.681
   14     29       2    0.497  0.0664        0.383        0.646
   15     25       2    0.458  0.0668        0.344        0.609
   17     23       2    0.418  0.0666        0.306        0.571
   20     19       3    0.352  0.0661        0.243        0.509
   21     16       1    0.330  0.0655        0.224        0.487
   24     14       1    0.306  0.0650        0.202        0.464
   26     12       1    0.281  0.0644        0.179        0.440
   27     11       1    0.255  0.0634        0.157        0.415
   28     10       1    0.230  0.0620        0.135        0.390
   43      9       1    0.204  0.0601        0.115        0.364</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>iptwsvyDFS <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> HAN_IPTW, <span class="at">weights =</span> <span class="sc">~</span> ate.weights)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>iptwDFS<span class="ot">&lt;-</span><span class="fu">svykm</span>(<span class="fu">Surv</span>(FU_DFS,RECUR)<span class="sc">~</span>Adju_TA, <span class="at">design=</span>iptwsvyDFS, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>iptwDFS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Weighted survival curves:
svykm(formula = Surv(FU_DFS, RECUR) ~ Adju_TA, design = iptwsvyDFS, 
    data = HAN_IPTW)
0 : Q1 = 11  median = 23  Q3 = Inf 
1 : Q1 = 9  median = 15  Q3 = 28 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">jskm</span>(unadjusteDFS, <span class="at">timeby =</span> <span class="dv">12</span>, <span class="at">ystratalabs=</span><span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">"Yes"</span>),</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ystrataname =</span> <span class="st">"Adjuvant Target therapy"</span>, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">FALSE</span>, <span class="at">pval=</span><span class="cn">FALSE</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlabs=</span><span class="st">"Months after Surgery"</span>, <span class="at">main =</span><span class="st">"Unadjusted"</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">dashed=</span><span class="cn">FALSE</span>,<span class="at">marks=</span><span class="cn">FALSE</span>,<span class="at">xlims=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),<span class="at">legendposition=</span><span class="fu">c</span>(<span class="fl">0.85</span>,<span class="fl">0.85</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 22 rows containing missing values or values outside the scale range
(`geom_step()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 16 rows containing missing values or values outside the scale range
(`geom_text()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">svyjskm</span>(iptwDFS, <span class="at">timeby =</span> <span class="dv">12</span>, <span class="at">ystratalabs=</span><span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">"Yes"</span>),</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">ystrataname =</span> <span class="st">"Adjuvant Target therapy"</span>, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">FALSE</span>, <span class="at">pval=</span><span class="cn">FALSE</span>,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlabs=</span><span class="st">"Months after Surgery"</span>, <span class="at">main =</span><span class="st">"Weighted"</span>,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">dashed=</span><span class="cn">FALSE</span>,<span class="at">marks=</span><span class="cn">TRUE</span>,<span class="at">xlims=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),<span class="at">legendposition=</span><span class="fu">c</span>(<span class="fl">0.85</span>,<span class="fl">0.85</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 22 rows containing missing values or values outside the scale range
(`geom_step()`).
Removed 16 rows containing missing values or values outside the scale range
(`geom_text()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [27]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Univarate Cox regression, unweighted, weighted ######################</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>TS_DFS<span class="ot">=</span><span class="fu">Surv</span>(HAN_IPTW<span class="sc">$</span>FU_DFS, HAN_IPTW<span class="sc">$</span>RECUR<span class="sc">==</span><span class="st">"1"</span>) <span class="co">#time object</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Uni, unweighted</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">mycph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">data=</span>HAN_IPTW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 mycph : perform coxph of individual expecting variables

 Call: TS_DFS ~ Adju_TA + Adju_target + Male + AGE60 + ASA3 + RTCOL +     LNR + pT4 + Pni1 + Lvi1 + Vi1 + PD + BILOBE + MULTI4 + SIZE4 +     CEA73 + M1_12m + PreHR_TA, data= HAN_IPTW </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               HR  lcl  ucl     p
Adju_TA      1.48 0.96 2.28 0.074
Adju_target1 1.36 0.84 2.18 0.208
Adju_target2 1.89 1.00 3.56 0.049
Male1        0.89 0.57 1.40 0.620
AGE601       0.92 0.60 1.41 0.704
ASA31        0.93 0.54 1.61 0.794
RTCOL1       1.08 0.63 1.87 0.773
LNR          1.62 0.56 4.67 0.375
pT41         1.19 0.63 2.25 0.582
Pni11        1.23 0.80 1.89 0.347
Lvi11        1.07 0.69 1.64 0.774
Vi11         1.72 1.09 2.70 0.019
PD1          0.79 0.25 2.50 0.688
BILOBE1      1.57 1.02 2.43 0.040
MULTI41      2.18 1.32 3.59 0.002
SIZE41       1.30 0.76 2.21 0.333
CEA731       2.00 1.13 3.56 0.018
M1_12mM1     1.43 0.76 2.69 0.270
PreHR_TA1    1.87 1.10 3.21 0.022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(out, <span class="at">file=</span><span class="st">"Cox_uni.csv"</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Uni, weighted</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>uni_ate <span class="ot">=</span> <span class="fu">mycphwt</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">data=</span>HAN_IPTW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 mycph : perform coxph of individual expecting variables

 Call: TS_DFS ~ Adju_TA + Adju_target + Male + AGE60 + ASA3 + RTCOL + , data= HAN_IPTW     LNR + pT4 + Pni1 + Lvi1 + Vi1 + PD + BILOBE + MULTI4 + SIZE4 + , data= HAN_IPTW     CEA73 + M1_12m + PreHR_TA, data= HAN_IPTW </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>uni_ate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               HR  lcl  ucl     p
Adju_TA      1.47 0.93 2.34 0.100
Adju_target1 1.29 0.77 2.15 0.328
Adju_target2 2.36 1.14 4.86 0.020
Male1        0.73 0.46 1.15 0.172
AGE601       1.10 0.69 1.75 0.700
ASA31        1.15 0.69 1.94 0.592
RTCOL1       0.92 0.53 1.61 0.774
LNR          1.91 0.60 6.07 0.272
pT41         1.10 0.41 2.93 0.847
Pni11        1.42 0.90 2.25 0.132
Lvi11        1.11 0.70 1.76 0.647
Vi11         1.66 1.00 2.76 0.052
PD1          0.46 0.10 2.06 0.308
BILOBE1      1.84 1.12 3.02 0.016
MULTI41      2.14 1.30 3.51 0.003
SIZE41       1.18 0.65 2.13 0.585
CEA731       1.59 0.76 3.31 0.216
M1_12mM1     1.47 0.69 3.13 0.323
PreHR_TA1    1.25 0.80 1.96 0.326</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(uni_ate, <span class="at">file=</span><span class="st">"Cox_uni_ate.csv"</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="do">##### Multivariate Cox regression, unweighted, weighted #################</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="do">## unweighted multi cox</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>COX<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73<span class="sc">+</span>PreHR_TA, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>COX<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_target<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73<span class="sc">+</span>PreHR_TA, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(COX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = TS_DFS ~ Adju_target + Vi1 + BILOBE + MULTI4 + 
    CEA73 + PreHR_TA, data = HAN_IPTW)

  n= 138, number of events= 85 

               coef exp(coef) se(coef)     z Pr(&gt;|z|)   
Adju_target1 0.2541    1.2893   0.2600 0.977  0.32851   
Adju_target2 0.3914    1.4790   0.3719 1.052  0.29259   
Vi11         0.6629    1.9405   0.2537 2.613  0.00897 **
BILOBE1      0.3138    1.3686   0.2969 1.057  0.29065   
MULTI41      0.3302    1.3913   0.3449 0.957  0.33833   
CEA731       0.3418    1.4075   0.3131 1.092  0.27502   
PreHR_TA1    0.6459    1.9078   0.3320 1.946  0.05167 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

             exp(coef) exp(-coef) lower .95 upper .95
Adju_target1     1.289     0.7756    0.7745     2.146
Adju_target2     1.479     0.6761    0.7136     3.066
Vi11             1.940     0.5153    1.1803     3.190
BILOBE1          1.369     0.7307    0.7648     2.449
MULTI41          1.391     0.7188    0.7077     2.735
CEA731           1.408     0.7105    0.7619     2.600
PreHR_TA1        1.908     0.5242    0.9953     3.657

Concordance= 0.632  (se = 0.032 )
Likelihood ratio test= 22.61  on 7 df,   p=0.002
Wald test            = 24.62  on 7 df,   p=9e-04
Score (logrank) test = 26.22  on 7 df,   p=5e-04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(COX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               HR  lcl  ucl     p
Adju_target1 1.29 0.77 2.15 0.329
Adju_target2 1.48 0.71 3.07 0.293
Vi11         1.94 1.18 3.19 0.009
BILOBE1      1.37 0.76 2.45 0.291
MULTI41      1.39 0.71 2.74 0.338
CEA731       1.41 0.76 2.60 0.275
PreHR_TA1    1.91 1.00 3.66 0.052</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>COX_step<span class="ot">&lt;-</span><span class="fu">step</span>(COX, <span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=735
TS_DFS ~ Adju_target + Vi1 + BILOBE + MULTI4 + CEA73 + PreHR_TA

              Df    AIC
- Adju_target  2 732.44
- MULTI4       1 733.91
- BILOBE       1 734.08
- CEA73        1 734.11
&lt;none&gt;           735.00
- PreHR_TA     1 736.53
- Vi1          1 739.53

Step:  AIC=732.44
TS_DFS ~ Vi1 + BILOBE + MULTI4 + CEA73 + PreHR_TA

           Df    AIC
- BILOBE    1 731.05
- MULTI4    1 731.93
- CEA73     1 731.95
&lt;none&gt;        732.44
- PreHR_TA  1 736.25
- Vi1       1 736.95

Step:  AIC=731.05
TS_DFS ~ Vi1 + MULTI4 + CEA73 + PreHR_TA

           Df    AIC
- CEA73     1 730.72
&lt;none&gt;        731.05
- MULTI4    1 733.53
- PreHR_TA  1 734.45
- Vi1       1 735.31

Step:  AIC=730.72
TS_DFS ~ Vi1 + MULTI4 + PreHR_TA

           Df    AIC
&lt;none&gt;        730.72
- MULTI4    1 734.33
- PreHR_TA  1 734.91
- Vi1       1 736.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(COX_step, <span class="at">digit=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            HR  lcl  ucl     p
Vi11      1.99 1.23 3.25 0.005
MULTI41   1.90 1.14 3.15 0.013
PreHR_TA1 2.19 1.22 3.94 0.009</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## weighted multi cox###</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ATE </span><span class="al">###</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>multi_ate<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Male<span class="sc">+</span>LNR<span class="sc">+</span>Pni1<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73, <span class="at">weights=</span>ate.weights, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>multi_ate<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>LNR<span class="sc">+</span>Pni1<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73, <span class="at">weights=</span>ate.weights, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_ate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = TS_DFS ~ Adju_target + Male + LNR + Pni1 + Vi1 + 
    BILOBE + MULTI4 + CEA73, data = HAN_IPTW, weights = ate.weights)

  n= 138, number of events= 85 

                 coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)  
Adju_target1  0.35783   1.43022  0.17162   0.25377  1.410   0.1585  
Adju_target2  1.03243   2.80789  0.24307   0.43154  2.392   0.0167 *
Male1        -0.43893   0.64473  0.16139   0.27189 -1.614   0.1065  
LNR          -0.14430   0.86563  0.45176   0.77452 -0.186   0.8522  
Pni11         0.50986   1.66506  0.16594   0.28295  1.802   0.0716 .
Vi11          0.28800   1.33375  0.18882   0.28106  1.025   0.3055  
BILOBE1       0.55414   1.74044  0.20447   0.36507  1.518   0.1290  
MULTI41       0.40610   1.50095  0.25464   0.39967  1.016   0.3096  
CEA731        0.05909   1.06087  0.25059   0.40191  0.147   0.8831  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

             exp(coef) exp(-coef) lower .95 upper .95
Adju_target1    1.4302     0.6992    0.8698     2.352
Adju_target2    2.8079     0.3561    1.2052     6.542
Male1           0.6447     1.5510    0.3784     1.099
LNR             0.8656     1.1552    0.1897     3.950
Pni11           1.6651     0.6006    0.9563     2.899
Vi11            1.3338     0.7498    0.7688     2.314
BILOBE1         1.7404     0.5746    0.8510     3.560
MULTI41         1.5010     0.6662    0.6858     3.285
CEA731          1.0609     0.9426    0.4826     2.332

Concordance= 0.634  (se = 0.043 )
Likelihood ratio test= 53.71  on 9 df,   p=2e-08
Wald test            = 25  on 9 df,   p=0.003
Score (logrank) test = 59  on 9 df,   p=2e-09,   Robust = 21.71  p=0.01

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHRwt</span>(multi_ate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                HR   lcl   ucl     p
Adju_target1 1.430 0.870 2.352 0.159
Adju_target2 2.808 1.205 6.542 0.017
Male1        0.645 0.378 1.099 0.106
LNR          0.866 0.190 3.950 0.852
Pni11        1.665 0.956 2.899 0.072
Vi11         1.334 0.769 2.314 0.306
BILOBE1      1.740 0.851 3.560 0.129
MULTI41      1.501 0.686 3.285 0.310
CEA731       1.061 0.483 2.332 0.883</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>Wt_step<span class="ot">&lt;-</span><span class="fu">step</span>(multi_ate, <span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1748.71
TS_DFS ~ Adju_target + Male + LNR + Pni1 + Vi1 + BILOBE + MULTI4 + 
    CEA73

              Df    AIC
- CEA73        1 1746.8
- LNR          1 1746.8
&lt;none&gt;           1748.7
- Vi1          1 1749.0
- MULTI4       1 1749.2
- BILOBE       1 1753.6
- Male         1 1753.9
- Pni1         1 1756.1
- Adju_target  2 1761.9

Step:  AIC=1746.77
TS_DFS ~ Adju_target + Male + LNR + Pni1 + Vi1 + BILOBE + MULTI4

              Df    AIC
- LNR          1 1744.9
&lt;none&gt;           1746.8
- Vi1          1 1747.2
- MULTI4       1 1747.5
- BILOBE       1 1751.6
- Male         1 1752.5
- Pni1         1 1754.2
- Adju_target  2 1760.0

Step:  AIC=1744.87
TS_DFS ~ Adju_target + Male + Pni1 + Vi1 + BILOBE + MULTI4

              Df    AIC
&lt;none&gt;           1744.9
- Vi1          1 1745.2
- MULTI4       1 1746.0
- BILOBE       1 1749.6
- Male         1 1750.5
- Pni1         1 1752.2
- Adju_target  2 1758.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Wt_step)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = TS_DFS ~ Adju_target + Male + Pni1 + Vi1 + BILOBE + 
    MULTI4, data = HAN_IPTW, weights = ate.weights)

  n= 138, number of events= 85 

                coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)   
Adju_target1  0.3622    1.4364   0.1697    0.2502  1.448  0.14769   
Adju_target2  1.0134    2.7548   0.2333    0.3706  2.734  0.00625 **
Male1        -0.4426    0.6424   0.1582    0.2596 -1.705  0.08822 . 
Pni11         0.5046    1.6564   0.1640    0.2724  1.853  0.06393 . 
Vi11          0.2744    1.3157   0.1762    0.2695  1.018  0.30859   
BILOBE1       0.5460    1.7263   0.2024    0.3491  1.564  0.11781   
MULTI41       0.4333    1.5423   0.2444    0.3705  1.169  0.24222   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

             exp(coef) exp(-coef) lower .95 upper .95
Adju_target1    1.4364     0.6962    0.8797     2.345
Adju_target2    2.7548     0.3630    1.3324     5.696
Male1           0.6424     1.5568    0.3862     1.068
Pni11           1.6564     0.6037    0.9712     2.825
Vi11            1.3157     0.7600    0.7758     2.231
BILOBE1         1.7263     0.5793    0.8709     3.422
MULTI41         1.5423     0.6484    0.7461     3.188

Concordance= 0.634  (se = 0.043 )
Likelihood ratio test= 53.56  on 7 df,   p=3e-09
Wald test            = 24.18  on 7 df,   p=0.001
Score (logrank) test = 58.42  on 7 df,   p=3e-10,   Robust = 20.86  p=0.004

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>t.step<span class="ot">&lt;-</span><span class="fu">extractHRwt</span>(Wt_step, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>t.step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                HR   lcl   ucl     p
Adju_target1 1.436 0.880 2.345 0.148
Adju_target2 2.755 1.332 5.696 0.006
Male1        0.642 0.386 1.068 0.088
Pni11        1.656 0.971 2.825 0.064
Vi11         1.316 0.776 2.231 0.309
BILOBE1      1.726 0.871 3.422 0.118
MULTI41      1.542 0.746 3.188 0.242</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(t.step, <span class="at">file=</span><span class="st">"multi_Cox_wt.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Resectability가 있는 대장암의 간 전이에 대한 가장 효과적인 치료법은 전이부위를 포함하는 절제 수술과 perioperative chemotherapy으로 제시되고 있습니다. 하지만, 수술 후 재발률이 18개월 이내 75%까지 보고될 만큼 매우 높습니다<span class="citation" data-cites="RN671"><sup><a href="#ref-RN671" role="doc-biblioref">1</a></sup></span>.</p>
<p>이에 항암화학요법에 표적 치료제를 추가하는 것에 대해 몇 몇 study가 보고되었으나 대규모의 높은 등급의 study는 아직 부족한 상태입니다. 이러한 study 에 따르면, 수술 후 표적치료제의 추가는 생존 이득이 없거나 오히려 유해한 결과로 나타났다고 보고되었습니다.</p>
<p>그러나 아직까지 국내 보험체계는 전이 부위를 포함하는 절제술 후 항암요법에 표적치료제를 추가하는 것에 제한이 없는 상황입니다.</p>
<p>따라서 대장암의 간 전이에서 근치적 절제술 후 항암화학요법을 진행한 환자에 대한 분석을 진행하여 표적치료제의 영향력을 평가하고자 하였습니다</p>
</section>
<section id="methods" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="methods"><span class="header-section-number">2</span> Methods</h2>
<section id="patients" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="patients"><span class="header-section-number">2.1</span> Patients</h3>
<p>본 연구는 후향적 연구로 2009년 1월부터 2022년 7월까지 원자력병원에서 시행한 대장암 간 전이에 대한 근치적 목적의 절제 수술 케이스를 대상으로 하였습니다.</p>
<p>이 중 FOLFOX FOLFIRI 등 Doublet chemotherapy를 시행한 케이스를 포함 하였으며, 타 장기 전이가 있거나, R1/2 절제의 경우, 항암치료를 받지 않거나 단일제제 항암치료 케이스는 제외하였습니다.</p>
<p>최종적으로 138개의 케이스에 대해 분석이 진행되었으며, Primary end point 는 간 전이 절제술로부터 progression free survival 로 설정하였습니다.</p>
</section>
<section id="statistical-analyses" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="statistical-analyses"><span class="header-section-number">2.2</span> Statistical analyses</h3>
<p>후향적 연구의 한계를 보정하기 위한 통계적 기법으로서 IPTW 를 적용하였습니다. 대상이 되는 138개의 original cohort 에 대해 다변량 로지스틱 회귀 분석을 통해 propensity score와 가중치 를 계산하여 가중치를 적용하여 보정한 데이터셋을 얻었습니다. 이렇게 보정된 weighted cohort 에 대해서 Absolute SMD 값을 통해 치료군과 대조군의 balance 를 확인하였습니다.</p>
<p>최종적으로 original cohort 와 weighted cohort 에서 콕스 회귀 분석을 시행하였으며 다변량 회귀분석에서는 후향 제거법을 사용하여 수술 후 표적치료제가 갖는 예후에의 영향력을 평가하였습니다.</p>
<p>Propensity score 를 구하기 위해 활용된 로지스틱 회귀분석에 적용된 변수는 다음과 같습니다. 환자 factor 로서 성별, 연령, ASA score 등 Primary tumor factor 로서 tumor location, lymph node ratio 등 Metastatic factor 로서 간엽 침범 정도, 전이 병변의 개수 등을 설정하였습니다. 이에 따라 Propensity score 에 따른 allocation probability 의 AUC 는 0.811, p-value 는 0.4906 로 나타났습니다 (<a href="#fig-AUC-allocation-probability-PSM" class="quarto-xref">Figure&nbsp;1</a>).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [28]:</pre></div><div id="cell-fig-AUC-allocation-probability-PSM" class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ROC</span>(<span class="at">form=</span>Adju_TA<span class="sc">~</span>pr.score, <span class="at">data=</span>HAN_IPTW, <span class="at">plot =</span> <span class="st">"ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-AUC-allocation-probability-PSM" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AUC-allocation-probability-PSM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-AUC-allocation-probability-PSM-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="index_files/figure-html/fig-AUC-allocation-probability-PSM-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AUC-allocation-probability-PSM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Propensity score 에 따른 allocation probability 의 AUC
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>All analyses were performed using R version 4.4.1 (R Core Team (2021). (R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria).</p>
</section>
</section>
<section id="results" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="results"><span class="header-section-number">3</span> Results</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [29]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>number_of_patients_included <span class="ot">&lt;-</span> <span class="fu">nrow</span>(HAN)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>number_of_Adju_TA_no<span class="ot">&lt;-</span><span class="fu">nrow</span>(<span class="fu">subset</span>(HAN, Adju_TA<span class="sc">==</span><span class="dv">0</span>))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>number_of_Adju_TA_yes<span class="ot">&lt;-</span><span class="fu">nrow</span>(<span class="fu">subset</span>(HAN, Adju_TA<span class="sc">==</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p><a href="#tbl-patient-characteristics-revised" class="quarto-xref">Table&nbsp;1</a> 은 연구에 포함된 환자 특성입니다. 138 개의 케이스에서 대조군의 크기는 77, 치료군의 크기는 61 명 이었습니다. 이 중, 표적치료제가 사용된 61명 중 베바시주맙이 42, 세툭시맙이 19명 이었습니다. 조사된 변수는 patient factor와 primary tumor factor, 그리고 metastases factor 로 구분하였습니다.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [30]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [31]:</pre></div><div><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>table1_revised<span class="ot">&lt;-</span>table1<span class="sc">$</span>res <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">format=</span><span class="st">"markdown"</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>table1_revised</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-patient-characteristics-revised" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-patient-characteristics-revised-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis
</figcaption>
<div aria-describedby="tbl-patient-characteristics-revised-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Adju_TA</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">Total</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AGE</td>
<td style="text-align: left;">59.0 ± 10.5</td>
<td style="text-align: left;">59.1 ± 9.0</td>
<td style="text-align: left;">59.1 ± 9.8</td>
<td style="text-align: left;">0.974</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.888</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">22 (28.6%)</td>
<td style="text-align: left;">19 (31.1%)</td>
<td style="text-align: left;">41 (29.7%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">55 (71.4%)</td>
<td style="text-align: left;">42 (68.9%)</td>
<td style="text-align: left;">97 (70.3%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Synch_M1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.121</td>
</tr>
<tr class="even">
<td style="text-align: left;">- M0</td>
<td style="text-align: left;">12 (15.6%)</td>
<td style="text-align: left;">17 (27.9%)</td>
<td style="text-align: left;">29 (21.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- M1</td>
<td style="text-align: left;">65 (84.4%)</td>
<td style="text-align: left;">44 (72.1%)</td>
<td style="text-align: left;">109 (79.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">M1_12m</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.025</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- M0</td>
<td style="text-align: left;">7 ( 9.1%)</td>
<td style="text-align: left;">15 (24.6%)</td>
<td style="text-align: left;">22 (15.9%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- M1</td>
<td style="text-align: left;">70 (90.9%)</td>
<td style="text-align: left;">46 (75.4%)</td>
<td style="text-align: left;">116 (84.1%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASA3</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.382</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">60 (77.9%)</td>
<td style="text-align: left;">52 (85.2%)</td>
<td style="text-align: left;">112 (81.2%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">17 (22.1%)</td>
<td style="text-align: left;">9 (14.8%)</td>
<td style="text-align: left;">26 (18.8%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">CCI7</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- CCI&lt;7</td>
<td style="text-align: left;">37 (48.1%)</td>
<td style="text-align: left;">29 (47.5%)</td>
<td style="text-align: left;">66 (47.8%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- CCI&gt;7</td>
<td style="text-align: left;">40 (51.9%)</td>
<td style="text-align: left;">32 (52.5%)</td>
<td style="text-align: left;">72 (52.2%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">RTCOL</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.961</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">63 (81.8%)</td>
<td style="text-align: left;">51 (83.6%)</td>
<td style="text-align: left;">114 (82.6%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">14 (18.2%)</td>
<td style="text-align: left;">10 (16.4%)</td>
<td style="text-align: left;">24 (17.4%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">LNR</td>
<td style="text-align: left;">0.1 [ 0.0; 0.2]</td>
<td style="text-align: left;">0.1 [ 0.0; 0.3]</td>
<td style="text-align: left;">0.1 [ 0.0; 0.3]</td>
<td style="text-align: left;">0.476</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pT4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.211</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">64 (83.1%)</td>
<td style="text-align: left;">56 (91.8%)</td>
<td style="text-align: left;">120 (87.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">13 (16.9%)</td>
<td style="text-align: left;">5 ( 8.2%)</td>
<td style="text-align: left;">18 (13.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Pni1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.599</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">46 (59.7%)</td>
<td style="text-align: left;">40 (65.6%)</td>
<td style="text-align: left;">86 (62.3%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">31 (40.3%)</td>
<td style="text-align: left;">21 (34.4%)</td>
<td style="text-align: left;">52 (37.7%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lvi1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.032</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">42 (54.5%)</td>
<td style="text-align: left;">45 (73.8%)</td>
<td style="text-align: left;">87 (63.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">35 (45.5%)</td>
<td style="text-align: left;">16 (26.2%)</td>
<td style="text-align: left;">51 (37.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Vi1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">54 (70.1%)</td>
<td style="text-align: left;">46 (75.4%)</td>
<td style="text-align: left;">100 (72.5%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">23 (29.9%)</td>
<td style="text-align: left;">15 (24.6%)</td>
<td style="text-align: left;">38 (27.5%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">PD</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">74 (96.1%)</td>
<td style="text-align: left;">58 (95.1%)</td>
<td style="text-align: left;">132 (95.7%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">3 ( 3.9%)</td>
<td style="text-align: left;">3 ( 4.9%)</td>
<td style="text-align: left;">6 ( 4.3%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">BILOBE</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.468</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">46 (59.7%)</td>
<td style="text-align: left;">41 (67.2%)</td>
<td style="text-align: left;">87 (63.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">31 (40.3%)</td>
<td style="text-align: left;">20 (32.8%)</td>
<td style="text-align: left;">51 (37.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">MULTI4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.183</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">65 (84.4%)</td>
<td style="text-align: left;">45 (73.8%)</td>
<td style="text-align: left;">110 (79.7%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">12 (15.6%)</td>
<td style="text-align: left;">16 (26.2%)</td>
<td style="text-align: left;">28 (20.3%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">SIZE4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.392</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">66 (85.7%)</td>
<td style="text-align: left;">48 (78.7%)</td>
<td style="text-align: left;">114 (82.6%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">11 (14.3%)</td>
<td style="text-align: left;">13 (21.3%)</td>
<td style="text-align: left;">24 (17.4%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">preHR_CEA</td>
<td style="text-align: left;">9.2 [ 3.2;25.1]</td>
<td style="text-align: left;">7.3 [ 4.8;44.4]</td>
<td style="text-align: left;">8.3 [ 3.7;28.0]</td>
<td style="text-align: left;">0.394</td>
</tr>
<tr class="even">
<td style="text-align: left;">CEA73</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.445</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">70 (90.9%)</td>
<td style="text-align: left;">52 (85.2%)</td>
<td style="text-align: left;">122 (88.4%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">7 ( 9.1%)</td>
<td style="text-align: left;">9 (14.8%)</td>
<td style="text-align: left;">16 (11.6%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreHR_chemo</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.028</td>
</tr>
<tr class="even">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">61 (79.2%)</td>
<td style="text-align: left;">37 (60.7%)</td>
<td style="text-align: left;">98 (71.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">16 (20.8%)</td>
<td style="text-align: left;">24 (39.3%)</td>
<td style="text-align: left;">40 (29.0%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PreHR_TA</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- 0</td>
<td style="text-align: left;">75 (97.4%)</td>
<td style="text-align: left;">40 (65.6%)</td>
<td style="text-align: left;">115 (83.3%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- 1</td>
<td style="text-align: left;">2 ( 2.6%)</td>
<td style="text-align: left;">21 (34.4%)</td>
<td style="text-align: left;">23 (16.7%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Post_HR_target_all</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">- Avastin</td>
<td style="text-align: left;">0 ( 0.0%)</td>
<td style="text-align: left;">42 (68.9%)</td>
<td style="text-align: left;">42 (30.4%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">- Erbitux</td>
<td style="text-align: left;">0 ( 0.0%)</td>
<td style="text-align: left;">19 (31.1%)</td>
<td style="text-align: left;">19 (13.8%)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">- None</td>
<td style="text-align: left;">77 (100.0%)</td>
<td style="text-align: left;">0 ( 0.0%)</td>
<td style="text-align: left;">77 (55.8%)</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div></div></div>
</div></div>
<p>연령은 치료군과 대조군 모두 59세 전후로 나타났으며 연령 및 성별에 있어 두 군 간의 통계적인 차이는 없었습니다. 진단 당시 간 전이를 동반하였거나 원발 부위 종양 절제술 후 12개월 이내에 간전이가 발견된 경우는 대조군에서 빈도가 유의하게 높았습니다. 또한 간 절제술 전 항암화학요법 혹은 표적치료제를 사용한 경우는 치료군에서 빈도가 유의하게 높았습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-3145534320.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3" title="Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis-저자가 별도로 편집한 table"><img src="images/clipboard-3145534320.png" class="img-fluid figure-img" width="700" alt="Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis-저자가 별도로 편집한 table"></a></p>
<figcaption>Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis-저자가 별도로 편집한 table</figcaption>
</figure>
</div>
<p>Primary tumor factor 에서는 pathology 소견 상 lymphatic invasion 을 보인 경우 대조군의 빈도가 유의하게 높았습니다. Metastases factor 에서는 병변의 양엽 침범 여부와 개수, 최대 직경에 대해 조사하였고 두 군 간의 유의한 차이는 없었습니다. 따라서 raw data에서는 치료군과 대조군 간의 불균형이 관찰됩니다.</p>
<p>따라서 propensity score를 사용해 가중치를 적용하여 데이터셋을 보정하는 IPTW 기법을 적용하였습니다.</p>
<p><a href="#fig-SMD" class="quarto-xref">Figure&nbsp;2</a> 은 original cohort 와 weighted cohort 의 absolute SMD 를 나타낸 것으로 빨간색 범례가 보정 전 특성을 나타내고, 파란색 범례가 보정 후 특성을 나타냅니다. 가중치 적용 후 absolute SMD 값이 0.2 이하로 조정되어 보정 후 치료군과 대조군이 적절한 balance 를 이루고 있는 것을 확인할 수 있습니다.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [32]:</pre></div><div id="cell-fig-SMD" class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(love_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-SMD" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SMD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-SMD-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="index_files/figure-html/fig-SMD-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SMD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Absolute SMD, Balance at original cohort &amp; weighted cohort
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [33]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>tab.unwt_MD<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">print</span>(tab.unwt, <span class="at">smd =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Stratified by Adju_TA
                   0            1            SMD   
  n                  77           61               
  Male = 1 (%)       55 (71.4)    42 (68.9)   0.056
  AGE60 = 1 (%)      37 (48.1)    30 (49.2)   0.023
  ASA3 = 1 (%)       17 (22.1)     9 (14.8)   0.190
  RTCOL = 1 (%)      14 (18.2)    10 (16.4)   0.047
  LNR (mean (SD))  0.18 (0.20)  0.17 (0.22)   0.022
  pT4 = 1 (%)        13 (16.9)     5 ( 8.2)   0.265
  Pni1 = 1 (%)       31 (40.3)    21 (34.4)   0.121
  Lvi1 = 1 (%)       35 (45.5)    16 (26.2)   0.409
  Vi1 = 1 (%)        23 (29.9)    15 (24.6)   0.119
  PD = 1 (%)          3 ( 3.9)     3 ( 4.9)   0.050
  BILOBE = 1 (%)     31 (40.3)    20 (32.8)   0.156
  MULTI4 = 1 (%)     12 (15.6)    16 (26.2)   0.264
  SIZE4 = 1 (%)      11 (14.3)    13 (21.3)   0.184
  CEA73 = 1 (%)       7 ( 9.1)     9 (14.8)   0.175
  M1_12m = M1 (%)    70 (90.9)    46 (75.4)   0.423
  PreHR_TA = 1 (%)    2 ( 2.6)    21 (34.4)   0.898</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [34]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [35]:</pre></div><div><div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab.unwt_MD, <span class="at">format=</span><span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-unweighted_SMD" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-unweighted_SMD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Unweighted SMD
</figcaption>
<div aria-describedby="tbl-unweighted_SMD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: left;">77</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Male = 1 (%)</td>
<td style="text-align: left;">55 (71.4)</td>
<td style="text-align: left;">42 (68.9)</td>
<td style="text-align: left;">0.056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AGE60 = 1 (%)</td>
<td style="text-align: left;">37 (48.1)</td>
<td style="text-align: left;">30 (49.2)</td>
<td style="text-align: left;">0.023</td>
</tr>
<tr class="even">
<td style="text-align: left;">ASA3 = 1 (%)</td>
<td style="text-align: left;">17 (22.1)</td>
<td style="text-align: left;">9 (14.8)</td>
<td style="text-align: left;">0.190</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RTCOL = 1 (%)</td>
<td style="text-align: left;">14 (18.2)</td>
<td style="text-align: left;">10 (16.4)</td>
<td style="text-align: left;">0.047</td>
</tr>
<tr class="even">
<td style="text-align: left;">LNR (mean (SD))</td>
<td style="text-align: left;">0.18 (0.20)</td>
<td style="text-align: left;">0.17 (0.22)</td>
<td style="text-align: left;">0.022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pT4 = 1 (%)</td>
<td style="text-align: left;">13 (16.9)</td>
<td style="text-align: left;">5 ( 8.2)</td>
<td style="text-align: left;">0.265</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pni1 = 1 (%)</td>
<td style="text-align: left;">31 (40.3)</td>
<td style="text-align: left;">21 (34.4)</td>
<td style="text-align: left;">0.121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lvi1 = 1 (%)</td>
<td style="text-align: left;">35 (45.5)</td>
<td style="text-align: left;">16 (26.2)</td>
<td style="text-align: left;">0.409</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vi1 = 1 (%)</td>
<td style="text-align: left;">23 (29.9)</td>
<td style="text-align: left;">15 (24.6)</td>
<td style="text-align: left;">0.119</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PD = 1 (%)</td>
<td style="text-align: left;">3 ( 3.9)</td>
<td style="text-align: left;">3 ( 4.9)</td>
<td style="text-align: left;">0.050</td>
</tr>
<tr class="even">
<td style="text-align: left;">BILOBE = 1 (%)</td>
<td style="text-align: left;">31 (40.3)</td>
<td style="text-align: left;">20 (32.8)</td>
<td style="text-align: left;">0.156</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MULTI4 = 1 (%)</td>
<td style="text-align: left;">12 (15.6)</td>
<td style="text-align: left;">16 (26.2)</td>
<td style="text-align: left;">0.264</td>
</tr>
<tr class="even">
<td style="text-align: left;">SIZE4 = 1 (%)</td>
<td style="text-align: left;">11 (14.3)</td>
<td style="text-align: left;">13 (21.3)</td>
<td style="text-align: left;">0.184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CEA73 = 1 (%)</td>
<td style="text-align: left;">7 ( 9.1)</td>
<td style="text-align: left;">9 (14.8)</td>
<td style="text-align: left;">0.175</td>
</tr>
<tr class="even">
<td style="text-align: left;">M1_12m = M1 (%)</td>
<td style="text-align: left;">70 (90.9)</td>
<td style="text-align: left;">46 (75.4)</td>
<td style="text-align: left;">0.423</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreHR_TA = 1 (%)</td>
<td style="text-align: left;">2 ( 2.6)</td>
<td style="text-align: left;">21 (34.4)</td>
<td style="text-align: left;">0.898</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div></div></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [36]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>tab.wt_MD<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">print</span>(tab.wt, <span class="at">smd =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Stratified by Adju_TA
                   0              1              SMD   
  n                 132.9          137.7               
  Male = 1 (%)       89.5 (67.4)    88.8 (64.5)   0.061
  AGE60 = 1 (%)      57.5 (43.3)    63.4 (46.0)   0.055
  ASA3 = 1 (%)       39.6 (29.8)    29.0 (21.1)   0.201
  RTCOL = 1 (%)      22.9 (17.3)    23.1 (16.7)   0.014
  LNR (mean (SD))    0.17 (0.19)    0.17 (0.21)   0.001
  pT4 = 1 (%)        17.9 (13.5)    18.4 (13.4)   0.003
  Pni1 = 1 (%)       53.4 (40.2)    55.7 (40.4)   0.006
  Lvi1 = 1 (%)       47.0 (35.4)    46.3 (33.6)   0.037
  Vi1 = 1 (%)        36.4 (27.4)    39.2 (28.4)   0.024
  PD = 1 (%)          6.0 ( 4.5)     5.1 ( 3.7)   0.038
  BILOBE = 1 (%)     42.9 (32.3)    50.2 (36.4)   0.087
  MULTI4 = 1 (%)     19.9 (15.0)    24.9 (18.1)   0.084
  SIZE4 = 1 (%)      29.4 (22.1)    33.3 (24.2)   0.049
  CEA73 = 1 (%)      11.3 ( 8.5)    13.9 (10.1)   0.054
  M1_12m = M1 (%)   116.2 (87.4)   115.8 (84.1)   0.096
  PreHR_TA = 1 (%)   19.8 (14.9)    23.2 (16.8)   0.051</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [37]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [38]:</pre></div><div><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab.wt_MD, <span class="at">format=</span><span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-weighted_SMD" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-weighted_SMD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: weighted SMD
</figcaption>
<div aria-describedby="tbl-weighted_SMD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: left;">132.9</td>
<td style="text-align: left;">137.7</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Male = 1 (%)</td>
<td style="text-align: left;">89.5 (67.4)</td>
<td style="text-align: left;">88.8 (64.5)</td>
<td style="text-align: left;">0.061</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AGE60 = 1 (%)</td>
<td style="text-align: left;">57.5 (43.3)</td>
<td style="text-align: left;">63.4 (46.0)</td>
<td style="text-align: left;">0.055</td>
</tr>
<tr class="even">
<td style="text-align: left;">ASA3 = 1 (%)</td>
<td style="text-align: left;">39.6 (29.8)</td>
<td style="text-align: left;">29.0 (21.1)</td>
<td style="text-align: left;">0.201</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RTCOL = 1 (%)</td>
<td style="text-align: left;">22.9 (17.3)</td>
<td style="text-align: left;">23.1 (16.7)</td>
<td style="text-align: left;">0.014</td>
</tr>
<tr class="even">
<td style="text-align: left;">LNR (mean (SD))</td>
<td style="text-align: left;">0.17 (0.19)</td>
<td style="text-align: left;">0.17 (0.21)</td>
<td style="text-align: left;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pT4 = 1 (%)</td>
<td style="text-align: left;">17.9 (13.5)</td>
<td style="text-align: left;">18.4 (13.4)</td>
<td style="text-align: left;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pni1 = 1 (%)</td>
<td style="text-align: left;">53.4 (40.2)</td>
<td style="text-align: left;">55.7 (40.4)</td>
<td style="text-align: left;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lvi1 = 1 (%)</td>
<td style="text-align: left;">47.0 (35.4)</td>
<td style="text-align: left;">46.3 (33.6)</td>
<td style="text-align: left;">0.037</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vi1 = 1 (%)</td>
<td style="text-align: left;">36.4 (27.4)</td>
<td style="text-align: left;">39.2 (28.4)</td>
<td style="text-align: left;">0.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PD = 1 (%)</td>
<td style="text-align: left;">6.0 ( 4.5)</td>
<td style="text-align: left;">5.1 ( 3.7)</td>
<td style="text-align: left;">0.038</td>
</tr>
<tr class="even">
<td style="text-align: left;">BILOBE = 1 (%)</td>
<td style="text-align: left;">42.9 (32.3)</td>
<td style="text-align: left;">50.2 (36.4)</td>
<td style="text-align: left;">0.087</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MULTI4 = 1 (%)</td>
<td style="text-align: left;">19.9 (15.0)</td>
<td style="text-align: left;">24.9 (18.1)</td>
<td style="text-align: left;">0.084</td>
</tr>
<tr class="even">
<td style="text-align: left;">SIZE4 = 1 (%)</td>
<td style="text-align: left;">29.4 (22.1)</td>
<td style="text-align: left;">33.3 (24.2)</td>
<td style="text-align: left;">0.049</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CEA73 = 1 (%)</td>
<td style="text-align: left;">11.3 ( 8.5)</td>
<td style="text-align: left;">13.9 (10.1)</td>
<td style="text-align: left;">0.054</td>
</tr>
<tr class="even">
<td style="text-align: left;">M1_12m = M1 (%)</td>
<td style="text-align: left;">116.2 (87.4)</td>
<td style="text-align: left;">115.8 (84.1)</td>
<td style="text-align: left;">0.096</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PreHR_TA = 1 (%)</td>
<td style="text-align: left;">19.8 (14.9)</td>
<td style="text-align: left;">23.2 (16.8)</td>
<td style="text-align: left;">0.051</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div></div></div>
</div></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-2590844408.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5" title="Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort - 저자가 별도로 편집한 그래프와 테이블 병합"><img src="images/clipboard-2590844408.png" class="img-fluid figure-img" alt="Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort - 저자가 별도로 편집한 그래프와 테이블 병합"></a></p>
<figcaption>Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort - 저자가 별도로 편집한 그래프와 테이블 병합</figcaption>
</figure>
</div>
<p><a href="#fig-survival" class="quarto-xref">Figure&nbsp;3</a> 은 연구에 포함된 환자 에 대한 Kaplan Meier 생존곡선입니다. 왼쪽은 metastases 에 대한 progression survival 을 나타내고 오른쪽은 overall survival 을 나타냅니다. f/u 기간의 중앙값은 45.5개월 이었으며, 관찰기간 중의 PFS event 는 85건, OS event 는 67건 이었습니다.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [39]:</pre></div><div id="cell-fig-survival" class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(PFS<span class="sc">$</span>plot, OS_TA<span class="sc">$</span>plot, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-survival" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-survival-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-survival-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="index_files/figure-html/fig-survival-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-survival-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Kaplan Meier survival curves for patients with targeted therapy after surgical resection of colorectal liver metastasis
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>테이블 2는 단변량 콕스 회귀 분석 결과입니다. 먼저 가중치를 적용하지 않은 original cohort 에서는 수술 전 CEA level 이 높은 경우, 수술 전 표적치료제 적용한 경우, vascular invasion 이 진행된 경우, 전이 병변이 간 양엽을 모두 침범한 경우, 간 전이 병변의 개수가 4개 이상일 경우에서 통계적으로 유의한 Poor prognostic factor 로 조사되었습니다.수술 후 표적치료제의 사용여부는 불량한 예후를 시사하는 경향을 보였으나 통계적으로 유의하지는 않았습니다.</p>
<p>Weighted cohort 에서는 보정 전 그룹과 비교하여 vascular invasion 이 있는 경우에서 Hazard ratio 1.70 으로 통계적으로 유의한 Poor prognostic factor 로 조사되었습니다. 보정 후에도 수술 후 표적치료제의 사용에 대한 경우는 불량한 예후를 시사하는 경향을 보였으나 통계적으로 유의하지는 않았습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-3985066224.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7" title="Table 2. Uni-variated Cox regression associated to PFS"><img src="images/clipboard-3985066224.png" class="img-fluid figure-img" alt="Table 2. Uni-variated Cox regression associated to PFS"></a></p>
<figcaption>Table 2. Uni-variated Cox regression associated to PFS</figcaption>
</figure>
</div>
<p>Table 3 는 다변량 콕스 회귀 분석 결과입니다. original cohort 에서는 간 전이 절제술 전 표적치료제를 사용한 경우, Vascular invasion 이 있는 경우, 전이 병변이 간 양엽을 모두 침범한 경우에서 통계적으로 유의한 Poor prognostic factor 로 조사되었습니다. 반면 Weighted cohort 에서는 Perineural invasion 여부와 더불어 수술 후 표적치료제의 사용이 유의한 poor prognostic factor 로 조사되었습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-1312926093.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" data-glightbox="description: .lightbox-desc-8" title="Table 3. multi-variated Cox regression associated to PFS"><img src="images/clipboard-1312926093.png" class="img-fluid figure-img" alt="Table 3. multi-variated Cox regression associated to PFS"></a></p>
<figcaption>Table 3. multi-variated Cox regression associated to PFS</figcaption>
</figure>
</div>
</section>
<section id="conclusion" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">4</span> Conclusion</h2>
<p>결론적으로 대장암 환자의 간절제술 후 항암치료에 표적 치료제를 추가하는 것은 생존 이점이 없으며, 오히려, 전이절제술 후 표적 치료제 사용이 progression 에 있어 해로운 영향력이 있을 수 있음을 확인하였습니다.</p>
</section>
<section id="discussion" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="discussion"><span class="header-section-number">5</span> Discussion</h2>
<p>이러한 표적치료제의 사용이 해로울 수 있는 가능성은, 2014년 LANCET oncology 에 게재된 New EPOC study에서 언급된 내용으로, 이 분석 결과를 통해 해당 내용을 데이터로 확인할 수 있었습니다<span class="citation" data-cites="RN672"><sup><a href="#ref-RN672" role="doc-biblioref">2</a></sup></span>.</p>
<p>다만, 분석에 포함된 대상군의 크기가 제한적이었고, 실시된 표적치료제 별 분석이 이루어지지 않았습니다. 또한, 후향적 연구의 한계로서 unmeasured confounder 가 존재하여 분석의 한계가 있을 수 있겠습니다.</p>
<p>따라서 절제 가능한 대장암 환자에 대해 수술 후 최적의 표적 치료제 적용에 대한 대규모 전향적 연구가 필요할 것으로 사료됩니다.</p>
<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;1: Propensity score 에 따른 allocation probability 의 AUC</span>
<span class="glightbox-desc lightbox-desc-3">Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis-저자가 별도로 편집한 table</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;2: Absolute SMD, Balance at original cohort &amp; weighted cohort</span>
<span class="glightbox-desc lightbox-desc-5">Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort - 저자가 별도로 편집한 그래프와 테이블 병합</span>
<span class="glightbox-desc lightbox-desc-6">Figure&nbsp;3: Kaplan Meier survival curves for patients with targeted therapy after surgical resection of colorectal liver metastasis</span>
<span class="glightbox-desc lightbox-desc-7">Table 2. Uni-variated Cox regression associated to PFS</span>
<span class="glightbox-desc lightbox-desc-8">Table 3. multi-variated Cox regression associated to PFS</span>
</div>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-RN671" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Penna C, Nordlinger B. <a href="https://doi.org/10.1016/s0039-6109(02)00051-8">Colorectal metastasis (liver and lung)</a>. <em>Surg Clin North Am</em>. 2002;82:1075–90, x–xi.</div>
</div>
<div id="ref-RN672" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Primrose J, Falk S, Finch-Jones M, et al. <a href="https://doi.org/10.1016/s1470-2045(14)70105-6">Systemic chemotherapy with or without cetuximab in patients with resectable colorectal liver metastasis: The new EPOC randomised controlled trial</a>. <em>Lancet Oncol</em>. 2014;15:601–11.</div>
</div>
</div>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"openEffect":"zoom","closeEffect":"zoom","loop":false,"selector":".lightbox","descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script> 
  
</body></html>