<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.5.55">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="JM HAN">
    <meta name="author" content="Ui Sep Shin">
    <meta name="keywords" content="colorectal cancer, liver metastases, preoperative chemotherapy, survival">

    <title>Role of Targeted Therapy after Surgical Resection of Colorectal Liver Metastases</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  
      <meta name="citation_title" content="Role of Targeted Therapy after Surgical Resection of Colorectal Liver Metastases">
<meta name="citation_keywords" content="colorectal cancer,liver metastases,preoperative chemotherapy,survival">
<meta name="citation_author" content="JM HAN">
<meta name="citation_author" content="Ui Sep Shin">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Colorectal metastasis (liver and lung);,citation_abstract=Distant metastases are the major cause of death for colorectal carcinoma patients. Depending on the primary tumor’s stage, liver metastases occur in 20;,citation_author=C. Penna;,citation_author=B. Nordlinger;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_issue=5;,citation_doi=10.1016/s0039-6109(02)00051-8;,citation_issn=0039-6109 (Print)
0039-6109;,citation_volume=82;,citation_journal_title=Surg Clin North Am;">
<meta name="citation_reference" content="citation_title=Systemic chemotherapy with or without cetuximab in patients with resectable colorectal liver metastasis: The new EPOC randomised controlled trial;,citation_abstract=BACKGROUND: Surgery for colorectal liver metastases results in an overall survival of about 40;,citation_author=J. Primrose;,citation_author=S. Falk;,citation_author=M. Finch-Jones;,citation_author=J. Valle;,citation_author=D. O’Reilly;,citation_author=A. Siriwardena;,citation_author=J. Hornbuckle;,citation_author=M. Peterson;,citation_author=M. Rees;,citation_author=T. Iveson;,citation_author=T. Hickish;,citation_author=R. Butler;,citation_author=L. Stanton;,citation_author=E. Dixon;,citation_author=L. Little;,citation_author=M. Bowers;,citation_author=S. Pugh;,citation_author=O. J. Garden;,citation_author=D. Cunningham;,citation_author=T. Maughan;,citation_author=J. Bridgewater;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_issue=6;,citation_doi=10.1016/s1470-2045(14)70105-6;,citation_issn=1470-2045;,citation_volume=15;,citation_journal_title=Lancet Oncol;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./index.qmd" class="btn btn-primary quarto-download-embed" download="index.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Role of Targeted Therapy after Surgical Resection of Colorectal Liver Metastases</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">JM HAN </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        KIRAMS
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Ui Sep Shin <a href="mailto:uisupshin@kirams.re.kr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-1714-7469" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        KIRAMS
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>


    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>colorectal cancer, liver metastases, preoperative chemotherapy, survival</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">2</span> Methods</a>
  <ul class="collapse">
  <li><a href="#patients" id="toc-patients" class="nav-link" data-scroll-target="#patients"><span class="header-section-number">2.1</span> Patients</a></li>
  <li><a href="#statistical-analyses" id="toc-statistical-analyses" class="nav-link" data-scroll-target="#statistical-analyses"><span class="header-section-number">2.2</span> Statistical analyses</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4</span> Conclusion</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">5</span> Discussion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>source_directory<span class="ot">&lt;-</span><span class="st">"source"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>source_filename<span class="ot">&lt;-</span><span class="st">"my_functions.R"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>source_path <span class="ot">&lt;&lt;-</span> <span class="fu">file.path</span>(project_path, source_directory)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>source_path_filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(source_path, source_filename)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(source_path_filename)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># source_filename&lt;-"mycphwt.R"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># source_path_filename &lt;- file.path(source_path, source_filename)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># source(source_path_filename)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(source_directory, source_filename, project_path, source_path, source_path_filename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>raw_data_directory<span class="ot">&lt;-</span><span class="st">"raw_data"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>raw_data_filename<span class="ot">&lt;-</span><span class="st">"deidentified_han20230213.xlsx"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>raw_data_path <span class="ot">&lt;&lt;-</span> <span class="fu">file.path</span>(project_path, raw_data_directory)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>raw_data_path_filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(raw_data_path, raw_data_filename)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(raw_data_path_filename)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(raw_data_directory, raw_data_filename, project_path, raw_data_path, raw_data_path_filename)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 교육적 목적으로 원본 데이터를 inital_raw_data에 복사해 두고 필요시 비교합니다.</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>initial_raw_data<span class="ot">&lt;-</span>raw_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># results='hide'옵션은 코드와 그 실행결과가 문서에서는 표시되지 않도록 숨깁니다.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># raw_data의 컬럼(=variable)들 중에서 결측치(=NA)가 cut-off 값 (아래에서는 5%) 이상이면 컬럼을 삭제함</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 문서에는 포함되지 않지만 아래의 라인을 실행하면 어떤 컬럼이 NA가 기준치 이상이라서 삭제되었는지 실행결과를 출력함.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>cleaned_data<span class="ot">&lt;-</span><span class="fu">my_eliminate_NA_columns</span>(raw_data, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 예시를 위해 만든 코드입니다. 실제로는 실행되지 않습니다.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">my_eliminate_NA_rows</span>(cleaned_data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> cleaned_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> raw_data <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(MRN, PreHR_chemo,  PreHR_TA, Adjuvant_Doublet, Adju_TA, Any_TA, AGE, SEX, ASA, CCI, SIDENESS, pT4, pT, pN, tN, L, N, V, Diff, Synch_M1, M1_12m, BILOBE, NUM_HM, MULTI4, HM_SIZE, SIZE4, preHR_CEA, Post_HR_target_all, FU_DFS, DEATH, FU_OS, RECUR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(raw_data, Adjuvant_Doublet<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>HAN<span class="ot">&lt;-</span>selected_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maxstat)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>TS_DFS<span class="ot">=</span><span class="fu">Surv</span>(HAN<span class="sc">$</span>FU_DFS, HAN<span class="sc">$</span>RECUR<span class="sc">==</span><span class="st">"1"</span>) <span class="co">#time object</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>LNR<span class="ot">&lt;-</span>HAN<span class="sc">$</span>pN<span class="sc">/</span>HAN<span class="sc">$</span>tN</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> preHR_CEA, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> CCI, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> ASA, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> NUM_HM, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> HM_SIZE, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">maxstat.test</span>(TS_DFS<span class="sc">~</span> LNR, <span class="at">data=</span>HAN,<span class="at">smethod=</span><span class="st">"LogRank"</span>,<span class="at">pmethod=</span><span class="st">"condMC"</span>,<span class="at">B=</span><span class="dv">999</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>CCI7<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>CCI<span class="sc">&gt;</span><span class="dv">7</span>,<span class="st">"CCI&gt;7"</span>,<span class="st">"CCI&lt;7"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>DFS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>DFS</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>PD<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>Diff<span class="sc">==</span><span class="st">"PD"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Pni1<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>N<span class="sc">==</span><span class="st">"Y"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Vi1<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>V<span class="sc">==</span><span class="st">"Y"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Lvi1<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>L<span class="sc">==</span><span class="st">"Y"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Male<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>SEX<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>RTCOL<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>SIDENESS<span class="sc">==</span><span class="st">"Rt"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>CCI7<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>CCI<span class="sc">&gt;</span><span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>AGE60<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>AGE<span class="sc">&gt;</span><span class="dv">60</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>CEA73<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>preHR_CEA<span class="sc">&gt;</span><span class="dv">73</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>ASA3<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>ASA<span class="sc">&gt;</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Adju_target<span class="ot">&lt;-</span><span class="fu">ifelse</span>(HAN<span class="sc">$</span>Post_HR_target_all<span class="sc">==</span><span class="st">"None"</span>,<span class="dv">0</span>,<span class="fu">ifelse</span>(HAN<span class="sc">$</span>Post_HR_target_all<span class="sc">==</span><span class="st">"Avastin"</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>Adju_target <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN<span class="sc">$</span>Adju_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moonBook)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">mytable</span>(Adju_TA<span class="sc">~</span>AGE<span class="sc">+</span>Male<span class="sc">+</span>Synch_M1<span class="sc">+</span>M1_12m<span class="sc">+</span>ASA3<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>preHR_CEA<span class="sc">+</span>CEA73<span class="sc">+</span>PreHR_chemo<span class="sc">+</span>PreHR_TA<span class="sc">+</span>Post_HR_target_all,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">show.total=</span><span class="cn">TRUE</span>, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">data=</span>HAN, <span class="at">method =</span> <span class="dv">3</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>number_of_patients_included <span class="ot">&lt;-</span> <span class="fu">nrow</span>(HAN)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>number_of_Adju_TA_no<span class="ot">&lt;-</span><span class="fu">nrow</span>(<span class="fu">subset</span>(HAN, Adju_TA<span class="sc">==</span><span class="dv">0</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>number_of_Adju_TA_yes<span class="ot">&lt;-</span><span class="fu">nrow</span>(<span class="fu">subset</span>(HAN, Adju_TA<span class="sc">==</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>PFS_TA<span class="ot">&lt;-</span><span class="fu">plot</span>(DFS, <span class="at">main=</span><span class="st">"Progression free survival, Target agent, yes/no"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"Survival Probability"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>TS_DFS<span class="ot">=</span><span class="fu">Surv</span>(HAN<span class="sc">$</span>FU_DFS, HAN<span class="sc">$</span>RECUR<span class="sc">==</span><span class="st">"1"</span>) <span class="co">#time object</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit_DFS <span class="ot">&lt;-</span><span class="fu">survfit</span>(HAN<span class="sc">$</span>TS_DFS<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>out_u<span class="ot">=</span><span class="fu">mycph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Any_TA<span class="sc">+</span>Adju_target<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_chemo<span class="sc">+</span>PreHR_TA, <span class="at">data=</span>HAN) <span class="co"># Univariate</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>out_u</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>out_m<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Any_TA<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73, <span class="at">data=</span>HAN)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(out_m)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>DFS_step<span class="ot">&lt;-</span><span class="fu">step</span>(out_m, <span class="at">direction=</span><span class="st">"backward"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Cox_step_dfs<span class="ot">&lt;-</span><span class="fu">extractHR</span>(DFS_step)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>Cox_step_dfs</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Cox_step_dfs, <span class="at">file=</span><span class="st">"Cox_step_DFS.csv"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(HAN<span class="sc">$</span>FU_OS)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(HAN<span class="sc">$</span>DEATH)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>HAN<span class="sc">$</span>TS_OS<span class="ot">=</span><span class="fu">Surv</span>(HAN<span class="sc">$</span>FU_OS, HAN<span class="sc">$</span>DEATH<span class="sc">==</span><span class="dv">1</span>) <span class="co">#time object</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>fit_OS <span class="ot">&lt;-</span><span class="fu">survfit</span>(HAN<span class="sc">$</span>TS_OS<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>out_u_os<span class="ot">=</span><span class="fu">mycph</span>(TS_OS<span class="sc">~</span>Adju_TA<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">++</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD, <span class="at">data=</span>HAN) <span class="co"># Univariate</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>out_u_os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>out_m_os<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_OS<span class="sc">~</span>Adju_TA<span class="sc">+</span>SEX<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>RTCOL<span class="sc">++</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD, <span class="at">data=</span>HAN)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(out_m_os)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survminer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DFS_all<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>HAN)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS_all)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(HAN<span class="sc">$</span>FU_DFS)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(HAN<span class="sc">$</span>FU_DFS)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(HAN<span class="sc">$</span>FU_DFS)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(HAN<span class="sc">$</span>FU_OS)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(HAN<span class="sc">$</span>FU_OS)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(HAN<span class="sc">$</span>FU_OS)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(HAN<span class="sc">$</span>RECUR)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(HAN<span class="sc">$</span>DEATH)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>DFS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>DFS</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>DFS_target_kind<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_DFS, RECUR<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_target, <span class="at">data=</span>HAN)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DFS_target_kind)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(DFS_target_kind, <span class="at">main=</span><span class="st">"Progression free survival, Kind of target agent"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"Survival Probability"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>,<span class="st">"green"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"None"</span>,<span class="st">"Bevacizumab"</span>,<span class="st">"Cetuximab"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>,<span class="st">"green"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(DFS_target_kind, </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval=</span><span class="cn">TRUE</span>, </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">break.time.by =</span> <span class="dv">12</span>,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.labs =</span> </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(<span class="st">"None"</span>, <span class="st">"Bevacizumab"</span>,<span class="st">"Cetuximab"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/Survival_Curve-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/Survival_Curve-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/Survival_Curve-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/Survival_Curve-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  DFS,                     <span class="co"># survfit object with calculated statistics.</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,        <span class="co"># show confidence intervals for </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># point estimaes of survival curves.</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int.style =</span> <span class="st">"step"</span>,  <span class="co"># customize style of confidence intervals</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in months"</span>,   <span class="co"># customize X axis label.</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">12</span>,     <span class="co"># break X axis in time intervals by 200.</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_light</span>(), <span class="co"># customize plot and risk table with a theme.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="st">"abs_pct"</span>,  <span class="co"># absolute number and percentage at risk.</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text.col =</span> T,<span class="co"># colour risk table text annotations.</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text =</span> <span class="cn">FALSE</span>,<span class="co"># show bars instead of names in text annotations</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in legend of risk table.</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncensor.plot =</span> <span class="cn">FALSE</span>,      <span class="co"># plot the number of censored subjects at time t</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#surv.median.line = "hv",  # add the median survival pointer.</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Adjuvant target agent, No"</span>, <span class="st">"Yes"</span>),    <span class="co"># change legend labels.</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>), <span class="co"># custom color palettes.</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cn">NULL</span>, <span class="co">#Cumulative risk</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">72</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/Survival_Curve-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/Survival_Curve-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>OS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_OS, DEATH<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span>Adju_TA, <span class="at">data=</span>HAN)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>OS_all<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(FU_OS, DEATH<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>HAN)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(OS_all)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>OS</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  OS,                     <span class="co"># survfit object with calculated statistics.</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,        <span class="co"># show confidence intervals for </span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># point estimaes of survival curves.</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int.style =</span> <span class="st">"step"</span>,  <span class="co"># customize style of confidence intervals</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in months"</span>,   <span class="co"># customize X axis label.</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">12</span>,     <span class="co"># break X axis in time intervals by 200.</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_light</span>(), <span class="co"># customize plot and risk table with a theme.</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="st">"abs_pct"</span>,  <span class="co"># absolute number and percentage at risk.</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text.col =</span> T,<span class="co"># colour risk table text annotations.</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text =</span> <span class="cn">FALSE</span>,<span class="co"># show bars instead of names in text annotations</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in legend of risk table.</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncensor.plot =</span> <span class="cn">FALSE</span>,      <span class="co"># plot the number of censored subjects at time t</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#surv.median.line = "hv",  # add the median survival pointer.</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Adjuvant target agent, No"</span>, <span class="st">"Yes"</span>),    <span class="co"># change legend labels.</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span>), <span class="co"># custom color palettes.</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cn">NULL</span>, <span class="co">#Cumulative risk</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">72</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="index_files/figure-html/overall_survival-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/overall_survival-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MatchIt)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(HAN[,<span class="fu">c</span>(<span class="st">"MRN"</span>,<span class="st">"Adju_TA"</span>,<span class="st">"Adju_target"</span>,<span class="st">"Male"</span>,<span class="st">"AGE60"</span>,<span class="st">"CCI7"</span>,<span class="st">"ASA3"</span>,<span class="st">"RTCOL"</span>,<span class="st">"LNR"</span>,<span class="st">"pT4"</span>,<span class="st">"Pni1"</span>,<span class="st">"Lvi1"</span>,<span class="st">"Vi1"</span>,<span class="st">"PD"</span>,<span class="st">"BILOBE"</span>,<span class="st">"MULTI4"</span>,<span class="st">"SIZE4"</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                               ,<span class="st">"CEA73"</span>,<span class="st">"M1_12m"</span>,<span class="st">"PreHR_chemo"</span>,<span class="st">"PreHR_TA"</span>,<span class="st">"FU_DFS"</span>,<span class="st">"RECUR"</span>)])</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">## DATA character change </span><span class="al">###</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Male <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Male)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>AGE60 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>AGE60)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>CCI7 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>CCI7)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>ASA3 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>CCI7)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>RTCOL <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>RTCOL)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>pT4 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>pT4)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Pni1 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Pni1)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Lvi1 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Lvi1)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>Vi1 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>Vi1)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>PD <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>PD)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>BILOBE <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>BILOBE)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>MULTI4 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>MULTI4)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>SIZE4 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>SIZE4)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>CEA73 <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>CEA73)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>M1_12m <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>M1_12m)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>PreHR_TA <span class="ot">&lt;-</span><span class="fu">as.factor</span>(HAN_IPTW<span class="sc">$</span>PreHR_TA)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>table1_iptw <span class="ot">&lt;-</span> <span class="fu">mytable</span>(Adju_TA<span class="sc">~</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>CCI7<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show.total=</span><span class="cn">TRUE</span>, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">data=</span>HAN_IPTW, <span class="at">method =</span> <span class="dv">3</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>table1_iptw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculating propensity score </span><span class="al">###</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>fit_IPTW<span class="ot">&lt;-</span><span class="fu">glm</span>(Adju_TA<span class="sc">~</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA, <span class="at">family=</span>binomial, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>factor<span class="ot">&lt;-</span><span class="fu">extractOR</span>(fit_IPTW, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>factor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                OR   lcl     ucl      p
(Intercept)  1.797 0.379   8.513 0.4602
Male1        0.892 0.347   2.288 0.8114
AGE601       0.796 0.105   6.061 0.8259
ASA31        1.176 0.149   9.296 0.8779
RTCOL1       1.777 0.590   5.350 0.3064
LNR          3.406 0.308  37.646 0.3174
pT41         0.470 0.129   1.713 0.2524
Pni11        1.324 0.515   3.399 0.5601
Lvi11        0.525 0.194   1.424 0.2059
Vi11         1.712 0.641   4.569 0.2832
PD1          0.932 0.119   7.292 0.9462
BILOBE1      0.346 0.112   1.073 0.0661
MULTI41      4.075 1.089  15.249 0.0370
SIZE41       1.388 0.450   4.281 0.5682
CEA731       1.443 0.365   5.707 0.6014
M1_12mM1     0.188 0.053   0.659 0.0091
PreHR_TA1   24.975 4.641 134.397 0.0002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_IPTW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Adju_TA ~ Male + AGE60 + ASA3 + RTCOL + LNR + pT4 + 
    Pni1 + Lvi1 + Vi1 + PD + BILOBE + MULTI4 + SIZE4 + CEA73 + 
    M1_12m + PreHR_TA, family = binomial, data = HAN_IPTW)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.58611    0.79363   0.739 0.460198    
Male1       -0.11478    0.48094  -0.239 0.811373    
AGE601      -0.22772    1.03555  -0.220 0.825948    
ASA31        0.16211    1.05487   0.154 0.877865    
RTCOL1       0.57511    0.56224   1.023 0.306364    
LNR          1.22567    1.22582   1.000 0.317372    
pT41        -0.75539    0.66004  -1.144 0.252427    
Pni11        0.28041    0.48122   0.583 0.560094    
Lvi11       -0.64350    0.50872  -1.265 0.205893    
Vi11         0.53757    0.50090   1.073 0.283185    
PD1         -0.07083    1.04981  -0.067 0.946208    
BILOBE1     -1.06017    0.57683  -1.838 0.066075 .  
MULTI41      1.40478    0.67336   2.086 0.036958 *  
SIZE41       0.32797    0.57464   0.571 0.568178    
CEA731       0.36650    0.70162   0.522 0.601412    
M1_12mM1    -1.67374    0.64154  -2.609 0.009082 ** 
PreHR_TA1    3.21786    0.85866   3.748 0.000179 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 189.45  on 137  degrees of freedom
Residual deviance: 142.96  on 121  degrees of freedom
AIC: 176.96

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(factor, <span class="at">file=</span><span class="st">"fit_PTR.csv"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>pr.score <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_IPTW, <span class="at">type =</span> <span class="st">"response"</span>) <span class="do">##attach propensity score##</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#HAN_IPTW$att.weights &lt;- with(HAN_IPTW, Adju_TA + (1-Adju_TA)*pr.score/(1-pr.score))</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>ate.weights <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(HAN_IPTW<span class="sc">$</span>Adju_TA<span class="sc">==</span><span class="st">"1"</span>, <span class="dv">1</span><span class="sc">/</span>HAN_IPTW<span class="sc">$</span>pr.score, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>HAN_IPTW<span class="sc">$</span>pr.score))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Goodness of Fit test, Hosmer Lemeshow test ####</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ResourceSelection")</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ResourceSelection 0.3-6      2023-06-27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(HAN_IPTW<span class="sc">$</span>Adju_TA, <span class="fu">fitted</span>(fit_IPTW))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  HAN_IPTW$Adju_TA, fitted(fit_IPTW)
X-squared = 7.4342, df = 8, p-value = 0.4906</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("Epi")</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(Epi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Epi</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("pROC")</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">=</span><span class="fu">ROC</span>(<span class="at">form=</span>Adju_TA<span class="sc">~</span>pr.score, <span class="at">data=</span>HAN_IPTW, <span class="at">plot =</span> <span class="st">"ROC"</span>) <span class="do">## discrimination of TA NO vs. TA YES group by propensity score ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="index_files/figure-html/ROC_curve-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/ROC_curve-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Weightit packages </span><span class="al">###</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("WeightIt")</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (WeightIt)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cobalt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> cobalt (Version 4.5.5, Build Date: 2024-04-02)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cobalt'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatchIt':

    lalonde</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>covs <span class="ot">&lt;-</span> <span class="fu">subset</span>(HAN_IPTW, <span class="at">select =</span> <span class="fu">c</span>(Male,AGE60,ASA3,RTCOL,LNR,pT4,Pni1,Lvi1,Vi1,PD,BILOBE,MULTI4,SIZE4,CEA73,M1_12m,PreHR_TA))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#W.out_att &lt;- weightit(Adju_TA~covs, data=HAN_IPTW, method="ps", estimand = "ATT") ##table#</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#bal.tab(W.out_att, un=TRUE, binary="std", thresholds=0.2)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>W.out_ate <span class="ot">&lt;-</span> <span class="fu">weightit</span>(Adju_TA<span class="sc">~</span>covs, <span class="at">data=</span>HAN_IPTW, <span class="at">method=</span><span class="st">"ps"</span>, <span class="at">estimand =</span> <span class="st">"ATE"</span>) <span class="do">##table#</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(W.out_ate, <span class="at">un=</span><span class="cn">TRUE</span>, <span class="at">binary=</span><span class="st">"std"</span>, <span class="at">thresholds=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Balance Measures
               Type Diff.Un Diff.Adj    M.Threshold
prop.score Distance  1.3000  -0.0544 Balanced, &lt;0.2
Male         Binary -0.0563  -0.0099 Balanced, &lt;0.2
AGE60        Binary  0.0226   0.0634 Balanced, &lt;0.2
ASA3         Binary  0.0102   0.0667 Balanced, &lt;0.2
RTCOL        Binary -0.0473   0.0213 Balanced, &lt;0.2
LNR         Contin. -0.0224   0.0065 Balanced, &lt;0.2
pT4          Binary -0.2646   0.0494 Balanced, &lt;0.2
Pni1         Binary -0.1208  -0.0207 Balanced, &lt;0.2
Lvi1         Binary -0.4092   0.0271 Balanced, &lt;0.2
Vi1          Binary -0.1188   0.0829 Balanced, &lt;0.2
PD           Binary  0.0498  -0.0142 Balanced, &lt;0.2
BILOBE       Binary -0.1557   0.1381 Balanced, &lt;0.2
MULTI4       Binary  0.2641   0.1087 Balanced, &lt;0.2
SIZE4        Binary  0.1845  -0.0309 Balanced, &lt;0.2
CEA73        Binary  0.1754   0.0711 Balanced, &lt;0.2
M1_12m_M1    Binary -0.4233  -0.1027 Balanced, &lt;0.2
PreHR_TA     Binary  0.8984  -0.1044 Balanced, &lt;0.2

Balance tally for mean differences
                   count
Balanced, &lt;0.2        17
Not Balanced, &gt;0.2     0

Variable with the greatest mean difference
 Variable Diff.Adj    M.Threshold
   BILOBE   0.1381 Balanced, &lt;0.2

Effective sample sizes
           Control Treated
Unadjusted   77.     61.  
Adjusted     32.89   40.16</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(W.out_ate, <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">1</span>), <span class="at">var.order =</span> <span class="st">"unadjusted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Standardized mean differences and raw mean differences are present in the same plot. 
Use the `stars` argument to distinguish between them and appropriately label the x-axis.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/Love_plots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index_files/figure-html/Love_plots-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Love plot 2, # balance plot#, Figure 1##</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">old=</span><span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"AGE60"</span>,<span class="st">"ASA3"</span>,<span class="st">"RTCOL"</span>,<span class="st">"LNR"</span>,<span class="st">"pT4"</span>,<span class="st">"Pni1"</span>,<span class="st">"Lvi1"</span>,<span class="st">"Vi1"</span>,<span class="st">"PD"</span>,<span class="st">"BILOBE"</span>,<span class="st">"MULTI4"</span>,<span class="st">"SIZE4"</span>,<span class="st">"CEA73"</span>,<span class="st">"M1_12m"</span>,<span class="st">"PreHR_TA"</span>,<span class="st">"ps"</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">new=</span><span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Age&gt;60"</span>,<span class="st">"ASA &gt;3"</span>,<span class="st">"Primary tumor at Rt colon"</span>,<span class="st">"Regional LN ratio"</span>,<span class="st">"pT4"</span>, <span class="st">"Perineural invasion of PT"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Lymphatic invasion of PT"</span>,<span class="st">"Vascular invasion of PT"</span>, <span class="st">"Poor differentiated"</span>, <span class="st">"Bilobar involvement of CRLM"</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Number of CRLM&gt;4"</span>, <span class="st">"Max size of CRLM&gt;4cm"</span>, <span class="st">"Pre-hepatectomy CEA&gt;73"</span>, <span class="st">"Synch or LM within 12mon"</span>,<span class="st">"Neoaduvant target agent"</span>, <span class="st">"propensity score"</span>))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(W.out_ate, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean.diffs"</span>), </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">threshold =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">2</span>), </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">binary =</span> <span class="st">"std"</span>, <span class="at">abs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">var.order =</span> <span class="st">"unadjusted"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">var.names =</span> v,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>, <span class="at">wrap =</span> <span class="dv">20</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample.names =</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Weighted"</span>),</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">line=</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">shapes =</span> <span class="fu">c</span>(<span class="st">"circle"</span>, <span class="st">"triangle"</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))<span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Absolute standadized mean difference"</span>)<span class="sc">+</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">3</span>),</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(), </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/Love_plots-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="index_files/figure-html/Love_plots-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tableone)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("survey")</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survey'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:WeightIt':

    calibrate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    dotchart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"AGE60"</span>,<span class="st">"ASA3"</span>,<span class="st">"RTCOL"</span>,<span class="st">"LNR"</span>,<span class="st">"pT4"</span>,<span class="st">"Pni1"</span>,<span class="st">"Lvi1"</span>,<span class="st">"Vi1"</span>,<span class="st">"PD"</span>,<span class="st">"BILOBE"</span>,<span class="st">"MULTI4"</span>,<span class="st">"SIZE4"</span>,<span class="st">"CEA73"</span>,<span class="st">"M1_12m"</span>,<span class="st">"PreHR_TA"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>tab.unwt <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars=</span>vars, <span class="at">strata=</span><span class="st">"Adju_TA"</span>, <span class="at">data=</span>HAN_IPTW, <span class="at">test =</span><span class="cn">FALSE</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab.unwt, <span class="at">smd=</span><span class="cn">TRUE</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>Svy <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> HAN_IPTW, <span class="at">weights =</span> <span class="sc">~</span> ate.weights)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Svy)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>Svy</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>tab.wt <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(<span class="at">vars=</span>vars, <span class="at">strata=</span><span class="st">"Adju_TA"</span>, <span class="at">data=</span>Svy, <span class="at">test =</span><span class="cn">FALSE</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab.wt, <span class="at">smd=</span><span class="cn">TRUE</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jskm)   </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>unadjusteDFS<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(HAN_IPTW<span class="sc">$</span>FU_DFS, <span class="fu">as.numeric</span>(HAN_IPTW<span class="sc">$</span>RECUR)) <span class="sc">~</span> HAN_IPTW<span class="sc">$</span>Adju_TA, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(unadjusteDFS)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>iptwsvyDFS <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> HAN_IPTW, <span class="at">weights =</span> <span class="sc">~</span> ate.weights)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>iptwDFS<span class="ot">&lt;-</span><span class="fu">svykm</span>(<span class="fu">Surv</span>(FU_DFS,RECUR)<span class="sc">~</span>Adju_TA, <span class="at">design=</span>iptwsvyDFS, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>iptwDFS</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">jskm</span>(unadjusteDFS, <span class="at">timeby =</span> <span class="dv">12</span>, <span class="at">ystratalabs=</span><span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">"Yes"</span>),</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">ystrataname =</span> <span class="st">"Adjuvant Target therapy"</span>, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">FALSE</span>, <span class="at">pval=</span><span class="cn">FALSE</span>,</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlabs=</span><span class="st">"Months after Surgery"</span>, <span class="at">main =</span><span class="st">"Unadjusted"</span>,</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">dashed=</span><span class="cn">FALSE</span>,<span class="at">marks=</span><span class="cn">FALSE</span>,<span class="at">xlims=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),<span class="at">legendposition=</span><span class="fu">c</span>(<span class="fl">0.85</span>,<span class="fl">0.85</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 22 rows containing missing values or values outside the scale range
(`geom_step()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 16 rows containing missing values or values outside the scale range
(`geom_text()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/TableOne_package-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="index_files/figure-html/TableOne_package-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">svyjskm</span>(iptwDFS, <span class="at">timeby =</span> <span class="dv">12</span>, <span class="at">ystratalabs=</span><span class="fu">c</span>(<span class="st">'No'</span>,<span class="st">"Yes"</span>),</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">ystrataname =</span> <span class="st">"Adjuvant Target therapy"</span>, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">FALSE</span>, <span class="at">pval=</span><span class="cn">FALSE</span>,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlabs=</span><span class="st">"Months after Surgery"</span>, <span class="at">main =</span><span class="st">"Weighted"</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">dashed=</span><span class="cn">FALSE</span>,<span class="at">marks=</span><span class="cn">TRUE</span>,<span class="at">xlims=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),<span class="at">legendposition=</span><span class="fu">c</span>(<span class="fl">0.85</span>,<span class="fl">0.85</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 22 rows containing missing values or values outside the scale range
(`geom_step()`).
Removed 16 rows containing missing values or values outside the scale range
(`geom_text()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/TableOne_package-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="index_files/figure-html/TableOne_package-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Univarate Cox regression, unweighted, weighted ######################</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>HAN_IPTW<span class="sc">$</span>TS_DFS<span class="ot">=</span><span class="fu">Surv</span>(HAN_IPTW<span class="sc">$</span>FU_DFS, HAN_IPTW<span class="sc">$</span>RECUR<span class="sc">==</span><span class="st">"1"</span>) <span class="co">#time object</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Uni, unweighted</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">mycph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>out</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(out, <span class="at">file=</span><span class="st">"Cox_uni.csv"</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Uni, weighted</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># uni_ate = mycphwt(TS_DFS~Adju_TA+Adju_target+Male+AGE60+ASA3+RTCOL+LNR+pT4+Pni1+Lvi1+Vi1+PD+BILOBE+MULTI4+SIZE4+CEA73+M1_12m+PreHR_TA, digits=2, data=HAN_IPTW)</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>uni_ate <span class="ot">=</span> <span class="fu">mycph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>AGE60<span class="sc">+</span>ASA3<span class="sc">+</span>RTCOL<span class="sc">+</span>LNR<span class="sc">+</span>pT4<span class="sc">+</span>Pni1<span class="sc">+</span>Lvi1<span class="sc">+</span>Vi1<span class="sc">+</span>PD<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>SIZE4<span class="sc">+</span>CEA73<span class="sc">+</span>M1_12m<span class="sc">+</span>PreHR_TA, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>uni_ate</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(uni_ate, <span class="at">file=</span><span class="st">"Cox_uni_ate.csv"</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="do">##### Multivariate Cox regression, unweighted, weighted #################</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="do">## unweighted multi cox</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>COX<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73<span class="sc">+</span>PreHR_TA, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>COX<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_target<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73<span class="sc">+</span>PreHR_TA, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(COX)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(COX)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>COX_step<span class="ot">&lt;-</span><span class="fu">step</span>(COX, <span class="at">direction=</span><span class="st">"backward"</span>)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(COX_step, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="do">## weighted multi cox###</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="do">## ATE </span><span class="al">###</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>multi_ate<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_TA<span class="sc">+</span>Male<span class="sc">+</span>LNR<span class="sc">+</span>Pni1<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73, <span class="at">weights=</span>ate.weights, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>multi_ate<span class="ot">&lt;-</span><span class="fu">coxph</span>(TS_DFS<span class="sc">~</span>Adju_target<span class="sc">+</span>Male<span class="sc">+</span>LNR<span class="sc">+</span>Pni1<span class="sc">+</span>Vi1<span class="sc">+</span>BILOBE<span class="sc">+</span>MULTI4<span class="sc">+</span>CEA73, <span class="at">weights=</span>ate.weights, <span class="at">data=</span>HAN_IPTW)</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_ate)</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a><span class="co">#원래코드에서는 extractHRwt 였으나 함수의 source 코드가 없어서 extractHR로 변경함 </span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a><span class="co">#extractHRwt(multi_ate)</span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a><span class="fu">extractHR</span>(multi_ate)</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>Wt_step<span class="ot">&lt;-</span><span class="fu">step</span>(multi_ate, <span class="at">direction=</span><span class="st">"backward"</span>)</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Wt_step)</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a><span class="co">#t.step&lt;-extractHRwt(Wt_step, digit=2)</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>t.step<span class="ot">&lt;-</span><span class="fu">extractHR</span>(Wt_step, <span class="at">digit=</span><span class="dv">2</span>)</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>t.step</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(t.step, <span class="at">file=</span><span class="st">"multi_Cox_wt.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Resectability가 있는 대장암의 간 전이에 대한 가장 효과적인 치료법은 전이부위를 포함하는 절제 수술과 perioperative chemotherapy으로 제시되고 있습니다. 하지만, 수술 후 재발률이 18개월 이내 75%까지 보고될 만큼 매우 높습니다 <span class="citation" data-cites="RN671">(<a href="#ref-RN671" role="doc-biblioref">Penna and Nordlinger 2002</a>)</span>.</p>
<p>이에 항암화학요법에 표적 치료제를 추가하는 것에 대해 몇 몇 study가 보고되었으나 대규모의 높은 등급의 study는 아직 부족한 상태입니다. 이러한 study 에 따르면, 수술 후 표적치료제의 추가는 생존 이득이 없거나 오히려 유해한 결과로 나타났다고 보고되었습니다.</p>
<p>그러나 아직까지 국내 보험체계는 전이 부위를 포함하는 절제술 후 항암요법에 표적치료제를 추가하는 것에 제한이 없는 상황입니다.</p>
<p>따라서 대장암의 간 전이에서 근치적 절제술 후 항암화학요법을 진행한 환자에 대한 분석을 진행하여 표적치료제의 영향력을 평가하고자 하였습니다</p>
</section>
<section id="methods" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="methods"><span class="header-section-number">2</span> Methods</h2>
<section id="patients" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="patients"><span class="header-section-number">2.1</span> Patients</h3>
<p>본 연구는 후향적 연구로 2009년 1월부터 2022년 7월까지 원자력병원에서 시행한 대장암 간 전이에 대한 근치적 목적의 절제 수술 케이스를 대상으로 하였습니다.</p>
<p>이 중 FOLFOX FOLFIRI 등 Doublet chemotherapy를 시행한 케이스를 포함 하였으며, 타 장기 전이가 있거나, R1/2 절제의 경우, 항암치료를 받지 않거나 단일제제 항암치료 케이스는 제외하였습니다.</p>
<p>최종적으로 138개의 케이스에 대해 분석이 진행되었으며, Primary end point 는 간 전이 절제술로부터 progression free survival 로 설정하였습니다.</p>
</section>
<section id="statistical-analyses" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="statistical-analyses"><span class="header-section-number">2.2</span> Statistical analyses</h3>
<p>후향적 연구의 한계를 보정하기 위한 통계적 기법으로서 IPTW 를 적용하였습니다. 대상이 되는 138개의 original cohort 에 대해 다변량 로지스틱 회귀 분석을 통해 propensity score와 가중치 를 계산하여 가중치를 적용하여 보정한 데이터셋을 얻었습니다. 이렇게 보정된 weighted cohort 에 대해서 Absolute SMD 값을 통해 치료군과 대조군의 balance 를 확인하였습니다.</p>
<p>최종적으로 original cohort 와 weighted cohort 에서 콕스 회귀 분석을 시행하였으며 다변량 회귀분석에서는 후향 제거법을 사용하여 수술 후 표적치료제가 갖는 예후에의 영향력을 평가하였습니다.</p>
<p>Propensity score 를 구하기 위해 활용된 로지스틱 회귀분석에 적용된 변수는 다음과 같습니다. 환자 factor 로서 성별, 연령, ASA score 등 Primary tumor factor 로서 tumor location, lymph node ratio 등 Metastatic factor 로서 간엽 침범 정도, 전이 병변의 개수 등을 설정하였습니다. 이에 따라 Propensity score 에 따른 allocation probability 의 AUC 는 0.811, p-value 는 0.4906 로 나타났습니다 (<a href="#fig-ROC" class="quarto-xref">Figure&nbsp;1</a>).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div id="cell-fig-ROC" class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ROC</span>(<span class="at">form=</span>Adju_TA<span class="sc">~</span>pr.score, <span class="at">data=</span>HAN_IPTW, <span class="at">plot =</span> <span class="st">"ROC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ROC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="index_files/figure-html/fig-ROC-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;1: Propensity score 에 따른 allocation probability 의 AUC"><img src="index_files/figure-html/fig-ROC-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Propensity score 에 따른 allocation probability 의 AUC
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>All analyses were performed using R version 4.4.1 (R Core Team (2021). (R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria).</p>
</section>
</section>
<section id="results" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="results"><span class="header-section-number">3</span> Results</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                    Descriptive Statistics by 'Adju_TA'                    
———————————————————————————————————————————————————————————————————————————— 
                           0                1              Total         p  
                         (N=77)           (N=61)          (N=138)     
———————————————————————————————————————————————————————————————————————————— 
 AGE                  59.0 ± 10.5      59.1 ±  9.0      59.1 ±  9.8    0.974
 Male                                                                  0.888
   - 0                 22 (28.6%)       19 (31.1%)       41 (29.7%)         
   - 1                 55 (71.4%)       42 (68.9%)       97 (70.3%)         
 Synch_M1                                                              0.121
   - M0                12 (15.6%)       17 (27.9%)       29 (21.0%)         
   - M1                65 (84.4%)       44 (72.1%)      109 (79.0%)         
 M1_12m                                                                0.025
   - M0                7 ( 9.1%)        15 (24.6%)       22 (15.9%)         
   - M1                70 (90.9%)       46 (75.4%)      116 (84.1%)         
 ASA3                                                                  0.382
   - 0                 60 (77.9%)       52 (85.2%)      112 (81.2%)         
   - 1                 17 (22.1%)       9 (14.8%)        26 (18.8%)         
 CCI7                                                                  1.000
   - 0                 37 (48.1%)       29 (47.5%)       66 (47.8%)         
   - 1                 40 (51.9%)       32 (52.5%)       72 (52.2%)         
 RTCOL                                                                 0.961
   - 0                 63 (81.8%)       51 (83.6%)      114 (82.6%)         
   - 1                 14 (18.2%)       10 (16.4%)       24 (17.4%)         
 LNR                 0.1 [ 0.0; 0.2]  0.1 [ 0.0; 0.3]  0.1 [ 0.0; 0.3] 0.476
 pT4                                                                   0.211
   - 0                 64 (83.1%)       56 (91.8%)      120 (87.0%)         
   - 1                 13 (16.9%)       5 ( 8.2%)        18 (13.0%)         
 Pni1                                                                  0.599
   - 0                 46 (59.7%)       40 (65.6%)       86 (62.3%)         
   - 1                 31 (40.3%)       21 (34.4%)       52 (37.7%)         
 Lvi1                                                                  0.032
   - 0                 42 (54.5%)       45 (73.8%)       87 (63.0%)         
   - 1                 35 (45.5%)       16 (26.2%)       51 (37.0%)         
 Vi1                                                                   0.619
   - 0                 54 (70.1%)       46 (75.4%)      100 (72.5%)         
   - 1                 23 (29.9%)       15 (24.6%)       38 (27.5%)         
 PD                                                                    1.000
   - 0                 74 (96.1%)       58 (95.1%)      132 (95.7%)         
   - 1                 3 ( 3.9%)        3 ( 4.9%)        6 ( 4.3%)          
 BILOBE                                                                0.468
   - 0                 46 (59.7%)       41 (67.2%)       87 (63.0%)         
   - 1                 31 (40.3%)       20 (32.8%)       51 (37.0%)         
 MULTI4                                                                0.183
   - 0                 65 (84.4%)       45 (73.8%)      110 (79.7%)         
   - 1                 12 (15.6%)       16 (26.2%)       28 (20.3%)         
 SIZE4                                                                 0.392
   - 0                 66 (85.7%)       48 (78.7%)      114 (82.6%)         
   - 1                 11 (14.3%)       13 (21.3%)       24 (17.4%)         
 preHR_CEA           9.2 [ 3.2;25.1]  7.3 [ 4.8;44.4]  8.3 [ 3.7;28.0] 0.394
 CEA73                                                                 0.445
   - 0                 70 (90.9%)       52 (85.2%)      122 (88.4%)         
   - 1                 7 ( 9.1%)        9 (14.8%)        16 (11.6%)         
 PreHR_chemo                                                           0.028
   - 0                 61 (79.2%)       37 (60.7%)       98 (71.0%)         
   - 1                 16 (20.8%)       24 (39.3%)       40 (29.0%)         
 PreHR_TA                                                              0.000
   - 0                 75 (97.4%)       40 (65.6%)      115 (83.3%)         
   - 1                 2 ( 2.6%)        21 (34.4%)       23 (16.7%)         
 Post_HR_target_all                                                    0.000
   - Avastin            0 ( 0.0%)       42 (68.9%)       42 (30.4%)         
   - Erbitux            0 ( 0.0%)       19 (31.1%)       19 (13.8%)         
   - None             77 (100.0%)        0 ( 0.0%)       77 (55.8%)         
———————————————————————————————————————————————————————————————————————————— </code></pre>
</div>
</div></div>
<p>Table 1은 연구에 포함된 환자 특성입니다. 138 개의 케이스에서 대조군의 크기는 77, 치료군의 크기는 61 명 이었습니다. 이 중, 표적치료제가 사용된 61명 중 베바시주맙이 42, 세툭시맙이 19명 이었습니다. 조사된 변수는 patient factor와 primary tumor factor, 그리고 metastases factor 로 구분하였습니다.</p>
<p>연령은 치료군과 대조군 모두 59세 전후로 나타났으며 연령 및 성별에 있어 두 군 간의 통계적인 차이는 없었습니다. 진단 당시 간 전이를 동반하였거나 원발 부위 종양 절제술 후 12개월 이내에 간전이가 발견된 경우는 대조군에서 빈도가 유의하게 높았습니다. 또한 간 절제술 전 항암화학요법 혹은 표적치료제를 사용한 경우는 치료군에서 빈도가 유의하게 높았습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-3145534320.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis"><img src="images/clipboard-3145534320.png" class="img-fluid figure-img" width="700" alt="Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis"></a></p>
<figcaption>Table 1. Baseline characteristics for patients with targeted therapy after surgical resection of colorectal liver metastasis</figcaption>
</figure>
</div>
<p>Primary tumor factor 에서는 pathology 소견 상 lymphatic invasion 을 보인 경우 대조군의 빈도가 유의하게 높았습니다. Metastases factor 에서는 병변의 양엽 침범 여부와 개수, 최대 직경에 대해 조사하였고 두 군 간의 유의한 차이는 없었습니다. 따라서 raw data에서는 치료군과 대조군 간의 불균형이 관찰됩니다.</p>
<p>따라서 propensity score를 사용해 가중치를 적용하여 데이터셋을 보정하는 IPTW 기법을 적용하였습니다.</p>
<p>Figure 2은, original cohort 와 weighted cohort 의 absolute SMD 를 나타낸 것으로 빨간색 범례가 보정 전 특성을 나타내고, 파란색 범례가 보정 후 특성을 나타냅니다. 가중치 적용 후 absolute SMD 값이 0.2 이하로 조정되어 보정 후 치료군과 대조군이 적절한 balance 를 이루고 있는 것을 확인할 수 있습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-2590844408.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort"><img src="images/clipboard-2590844408.png" class="img-fluid figure-img" alt="Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort"></a></p>
<figcaption>Figure 2. Absolute SMD, Balance at original cohort &amp; weighted cohort</figcaption>
</figure>
</div>
<p>Figure 3은 연구에 포함된 환자 에 대한 Kaplan Meier 생존곡선입니다. 왼쪽은 metastases 에 대한 progression survival 을 나타내고 오른쪽은 overall survival 을 나타냅니다. f/u 기간의 중앙값은 45.5개월 이었으며, 관찰기간 중의 PFS event 는 85건, OS event 는 67건 이었습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-3783060595.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure 3. Kaplan Meier Analysis, original cohort"><img src="images/clipboard-3783060595.png" class="img-fluid figure-img" alt="Figure 3. Kaplan Meier Analysis, original cohort"></a></p>
<figcaption>Figure 3. Kaplan Meier Analysis, original cohort</figcaption>
</figure>
</div>
<p>테이블 2는 단변량 콕스 회귀 분석 결과입니다. 먼저 가중치를 적용하지 않은 original cohort 에서는 수술 전 CEA level 이 높은 경우, 수술 전 표적치료제 적용한 경우, vascular invasion 이 진행된 경우, 전이 병변이 간 양엽을 모두 침범한 경우, 간 전이 병변의 개수가 4개 이상일 경우에서 통계적으로 유의한 Poor prognostic factor 로 조사되었습니다.수술 후 표적치료제의 사용여부는 불량한 예후를 시사하는 경향을 보였으나 통계적으로 유의하지는 않았습니다.</p>
<p>Weighted cohort 에서는 보정 전 그룹과 비교하여 vascular invasion 이 있는 경우에서 Hazard ratio 1.70 으로 통계적으로 유의한 Poor prognostic factor 로 조사되었습니다. 보정 후에도 수술 후 표적치료제의 사용에 대한 경우는 불량한 예후를 시사하는 경향을 보였으나 통계적으로 유의하지는 않았습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-3985066224.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Table 2. Uni-variated Cox regression associated to PFS"><img src="images/clipboard-3985066224.png" class="img-fluid figure-img" alt="Table 2. Uni-variated Cox regression associated to PFS"></a></p>
<figcaption>Table 2. Uni-variated Cox regression associated to PFS</figcaption>
</figure>
</div>
<p>Table 3 는 다변량 콕스 회귀 분석 결과입니다. original cohort 에서는 간 전이 절제술 전 표적치료제를 사용한 경우, Vascular invasion 이 있는 경우, 전이 병변이 간 양엽을 모두 침범한 경우에서 통계적으로 유의한 Poor prognostic factor 로 조사되었습니다. 반면 Weighted cohort 에서는 Perineural invasion 여부와 더불어 수술 후 표적치료제의 사용이 유의한 poor prognostic factor 로 조사되었습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/clipboard-1312926093.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Table 3. multi-variated Cox regression associated to PFS"><img src="images/clipboard-1312926093.png" class="img-fluid figure-img" alt="Table 3. multi-variated Cox regression associated to PFS"></a></p>
<figcaption>Table 3. multi-variated Cox regression associated to PFS</figcaption>
</figure>
</div>
</section>
<section id="conclusion" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">4</span> Conclusion</h2>
<p>결론적으로 대장암 환자의 간절제술 후 항암치료에 표적 치료제를 추가하는 것은 생존 이점이 없으며, 오히려, 전이절제술 후 표적 치료제 사용이 progression 에 있어 해로운 영향력이 있을 수 있음을 확인하였습니다.</p>
</section>
<section id="discussion" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="discussion"><span class="header-section-number">5</span> Discussion</h2>
<p>이러한 표적치료제의 사용이 해로울 수 있는 가능성은, 2014년 LANCET oncology 에 게재된 New EPOC study에서 언급된 내용으로, 이 분석 결과를 통해 해당 내용을 데이터로 확인할 수 있었습니다 <span class="citation" data-cites="RN672">(<a href="#ref-RN672" role="doc-biblioref">Primrose et al. 2014</a>)</span>.</p>
<p>다만, 분석에 포함된 대상군의 크기가 제한적이었고, 실시된 표적치료제 별 분석이 이루어지지 않았습니다. 또한, 후향적 연구의 한계로서 unmeasured confounder 가 존재하여 분석의 한계가 있을 수 있겠습니다.</p>
<p>따라서 절제 가능한 대장암 환자에 대해 수술 후 최적의 표적 치료제 적용에 대한 대규모 전향적 연구가 필요할 것으로 사료됩니다.</p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-RN671" class="csl-entry" role="listitem">
Penna, C., and B. Nordlinger. 2002. <span>“Colorectal Metastasis (Liver and Lung).”</span> Journal Article. <em>Surg Clin North Am</em> 82 (5): 1075–90, x–xi. <a href="https://doi.org/10.1016/s0039-6109(02)00051-8">https://doi.org/10.1016/s0039-6109(02)00051-8</a>.
</div>
<div id="ref-RN672" class="csl-entry" role="listitem">
Primrose, J., S. Falk, M. Finch-Jones, J. Valle, D. O’Reilly, A. Siriwardena, J. Hornbuckle, et al. 2014. <span>“Systemic Chemotherapy with or Without Cetuximab in Patients with Resectable Colorectal Liver Metastasis: The New EPOC Randomised Controlled Trial.”</span> Journal Article. <em>Lancet Oncol</em> 15 (6): 601–11. <a href="https://doi.org/10.1016/s1470-2045(14)70105-6">https://doi.org/10.1016/s1470-2045(14)70105-6</a>.
</div>
</div>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"selector":".lightbox","openEffect":"zoom","closeEffect":"zoom","loop":false,"descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>